<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            * { box-sizing: border-box; }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                max-width: 768px;
                margin: 0 auto;
                padding: 16px;
                font-size: 18px;
                line-height: 1.6;
                height: 100%;
            }

            .staticrypt-content {
                height: 100%;
            }

            .staticrypt-page {
                padding-top: 20%;
            }

            .staticrypt-title {
                font-size: 1.5em;
                font-weight: bold;
                margin: 0 0 0.5em 0;
            }

            .staticrypt-instructions {
                margin-bottom: 1em;
            }

            .staticrypt-hr {
                border: 0;
                border-top: 1px solid black;
                margin: 1em 0;
            }

            .staticrypt-password-container {
                position: relative;
                margin-bottom: 1em;
            }

            .staticrypt-form input[type="password"],
            .staticrypt-form input[type="text"] {
                width: 100%;
                padding: 8px;
                font-size: 18px;
                border: 1px solid black;
                background: inherit;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                width: 20px;
                opacity: 60%;
                padding: 10px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
            }

            .staticrypt-decrypt-button {
                padding: 8px 16px;
                font-size: 18px;
                border: 1px solid black;
                background: white;
                color: black;
                cursor: pointer;
            }

            .staticrypt-decrypt-button:hover {
                background: black;
                color: white;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                animation: spinner-border 0.75s linear infinite;
            }

            @keyframes spinner-border {
                100% { transform: rotate(360deg); }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"a716f923456e040f8758b72a183daedd3db912dcf67145d7dd05d467709e47c550aa0316b3a3e741d62f707a757d5b1ae15801aa81c6b1cd087e06a0b6325d2aca43b64a56280bbd9bef121701f08aafe24664e5465f0abf83e91ddbc19d4734a124593e6c4690041bba8646b20b88f9c1d98bb6346fe248a5433912acd560c1f057a423da2428b3280aeb33cd685ec4deed4bd32d17cc660eb21cb659d55b106aec23b65dd386ba424e09370e93866684583020fd8d9d2b944dae137b6752df8d2434d6ba1e4c509c1a109a8a73432a096ba1d6d972da852803cd69a3ec6aef216e673b849ce1146d8f428f9ebf8ccbf2460a0ae51131cb5215bea1f4b31c2f92dbe15dcf76c305e8f482ba81fcba81393a8a3bd3e42f1d0a36d046de924c46a8dba95ccf55e27fdff1c27eaafe99f8815279452a57d2f2105f063a8b22e7adb7595a64e05b0c433ee62fb07a2336a069b39bcb7799fe53cbe0fd43d0772d4479714ab567e1eaa99c2d1d353c2cb56c137f1bf40f67d2d82b3b8206dfd09719766a8c4fd1217b7e0563dc4f6337cad3b23a004bc79a16137ddc22a5f0ac63f204fe3710ca60511655b5ab397081ca7390dd70054cbcc4701239c509c2a26d1cc2c124299ca16f0d7496cd3044c3527102b55e18859ddf9aa75c0a584b1fcc98cab659c9886e6cb72d463e745e43a13ac241469f55735f933e0f8ad568932c00f1e0364ba76dce2b03aaaa75cbaec144686392cd3158622b16fe202589be9ccd9d5da200c1cc5a3d083e7ff3b4c32522324be28cba86f0822e8088d15bd003a294ad0b799b8253229157d4df161c36a690f6f6992a1ab5dbc54e04bbc3597f01636cf4ad2328730a39233e2adae82dc3993a51d2dcef346b85fc05b6281098ed431319840835cc24c148b28829115e0df775f4ec203019de3fb1de29dd8448437ec5caf7709a3569c5978ae62af428852beceb08c8cb7ec6b0227d040a618bc2cc73d162f2b05f468d2f323738eb70010de953fa84ff1d1a2a4fd288cc7daa8780939a0acf54b82cc936aad75bb7f949a229f47191a94ab92eb4e673e4d51d00ae986de02459e87996b2bef3335ae3f3365a99dd8ddd403321efade4714627f690212ed99e9505f58a5a72d3915b6dd347b51b158eee659a2f9c51807bdb7113a1d6a6402c79505c08c1e9d57a4fabd1b07dba143cd1e0853d4c0410ca4dd09485f217ef2cbfae1c2bb3990fed3d16ef1067356bd80c07cf3a8184e1b3ccf62db419b7fedac881b643daf866a2235810c717ed0ae7ddd9bf788e47b48c54082060bf4bbce3646f60e7519a62aedcf1de213585d3ee6676b160f8570311177d539434375072cf3a816a38e9d0411b579bbeecdf7092826e5938cac018e4aaa16c28b5405bce55e1a5386cd7a3fb474674c28ba367a30355c90fb3fb2ed0ca17f753f60207b69dde637e33558fea723c4ef65532bfb31826f57a4db60954fee1cc6e13634d8a960de39d1b6a596f29b76f1cfa695b860b9d4361de5172bba84ad8c3119c14dce3a57d88658e76edf18f4077f5ca25085a60184dbcd4154305b4516c71429be84bcf6918ce5d2cf9a1cee84f4f5b2a63b5400a41ba94721e26db8c54fedd337e8f704d1612d37c55c14c468af28409bdfc9014d3d1a4906eb4592ce9d3465808f603f871136f37d6c7344a8f8e46d2a58b8281747aadab9b38dece82a60ea326dda5c57d81542ff42c6dbeeecd0fbf8b0cad7c1b9e1ead4d26d1b83af49060637c6953687e92185d200604b159452a4950cc921ee9b731670a2a725b83891279473c6c27aae5689cfd6bc50d268603e2e2980224e8f3d2c314f384fd15aa19e7363b77b1d21070c9111840c989c45742e1b6995c6cbb3714ca0ccd40684fe65746434f1bbacd37d09925eef305de8ae8b2cc257557a0efcf0a18f40d26dc3db0009d9e875b29fa830e31cba00148c5e37fd4f558aad4d7452408fb46435e921430ed4fa10f125ad5fb7f0696bc973b9f72b8271b2ca0a252426c32cc4ab01525c33d086ce59cd9442281c103a0f717f15b0cb80e3a560578ae371a492d3d7431fbfefbe95af3dc8dade8a14a1bc27aa9052d192729ac6056875f39d968525c5fb419f6d70b8567d7a80149db10ddcc90d570945481e280659153b141e5753f8efaac119be098f7bae3af4dfba4cf1d149a0b25c013ababb74c7c544f9c951e64f947d5c0b1c2cf359abbd3ab83c4f56e0a0930fec41efa2dabbc993aca64ab7f0759e756a74a966b76c193e9985f7d26e0390fe846cafc6f812ffcafdc351abf8c2fd453a407530eb14cdd22c6caab1009c79d535fcdd8334236d0d82a226dcca0bcc44e1c840d73a7f9937aae156f97ac6f849e29e30389f07112901f9bfbf8eff447775dff11ff51d2b7120183eb510986d91fadc4a1fc1e8abdb98425d012fb3213430cc36b23a31449a96597b678ae4fd1163dcc8e8678d4160111b24e5214885583f644c7435bc92b4d9b683212352a5ec4844dbc8f2748d4b7a5a3f622dea752dec45cc0cb5aa1ed975927a51b317c5ecf50b6ad2f9a5f49f256af7d4fadfa0f97b19626169cc776804bf8f09cec1af70652a6bf0e6888fbe3ded16ebae60a29da69d6179e7f6864ab21dd7c797331d2b7fa4984488dc5f7fc466e440f216c15b1a201e8844a925786fbcd1627db398020430554fbe2e87b058c9527161276581850fd8fab9cac6095225e192d1e63d024fef0c472658e225fd052052303a287b686a6928ff9f696b024b204a39bf592c005b44d069088739a3a35abb9f72d67370d920744832ae541e0f4f4bb2ed50b9d9b9fe4b095233f62f51293e3002d2fab19252f1e3381addb1bf414d8c9e905e0eeabda2c3d2cebadcb2100ae547c0a9946c0a1724b3dc2cbd9ae27c8d34532b381338816933b7e69d3b0c1334e7dc3e67626c5cb0374b810b3ade184d2c5e7e552385f303b6e19784d85d8c22208e37a5c1a22f77073f774f90d43f09c3106935512144cf00669c6f7475fe852600a0c91c4f8ca16d92f1e9052f75aaf32a5df3f80ce5e2cc6b48876ec04438a921a2ca2a23e9d7712112c1e4b7296caaaaca94f77d3d6ca352e143eceed44ea53844014b7565d4993f62f6a12e3833df04a78aa512e9cd9a77d1eced9a2d44c8bf0033ca74a46b905a079622130dd1dfc81e59107231b47dc6a161863d45b7c4af25a7754b815f651eed2ae631b137dfa4a576bb3cea3932995cbb73baad676c8b398b5d1507678b68263af889b0a513f3181c4f75b1455cb8ec47e4f2fc4eb2a3ed52e872e4f71eba880f591b45d8b4e326516185579b4ba1191df827aee4814cfc0bbdeb976bd5d50eff147eea59434026c6a14f88407ab0f8a07fc19bc83fcc5055a58f461621048ad813cf555526a0d5b0ac09f0e0191812868b8accfd4268e02f8404c505e20b9d0b72c8c9be3b042f0d61b81c39ca2f22903dac931ec319ae5fc561e1d3319865ce8fb3e61d894ddb281a05cc00123254acb4258710be876357683067c4d19c569bd7160465bc7d3708b0bdd2e2da1a4bcfb220236388581d1410e8181638e11f1134c5e38c3bffd82212732771c37d9dca80c70669fca0ad2dc348de426bfb3b168828eb5a8382de954f9b3382d623726e7f4051e11ea23b7e9a45fd49fb48c2b081d9c76e38e166e4edf3880e8864003fb1d25c0c9518207cf1b813a98bb5efaab436d2b27c23224cc605935a38133851f628ab134791a691fc9b2917b9a309adc8536c6ec940693b4d812ebd47e133a37bca5a7962b11823de4b1ecc1b024aa4333ca8bd1861b99a8471b8d948d2494ab76cdd6d688a52872d2a765c1628deea2125da6d1488cd53b94ef2bb5fc672e9433331e7841cb02d00b914907f02366c410e4d350e4b107cd946faa322722bc655b5e52c3047db952f21f6af95be2f521d022b2c9027cc8d0b9adf182217649f7b5323a9ea402f98d298d0a151023ce66390c05d216f4c897ab55f0ac14920b9b1cc83bdea20fe3e5a2db9e45beaf146d8a5ee76399a4281b4b9997f312b2b9efa5e590ff8864c4844ee84e73bc29aabc27e6788c4653be504795b83d45a5a60702c901a31dd09acda2f50f1a6fcf04373cb8a17a6bf2486189b9f5fa66fe4d2756dbe2a3c153fba45d072b24275af10a3071d70421eea3609dc08cf1406bc5cdf9aecf1fed616154bc25fe252876d0b55030888eea7e17769b847a06b7482b3d1a163b115f2f1fb1ac7802bb13c90341ec4753cebe180193d518c8209010e2e3ad4fdf74dfdfacb28e605574557eb40dd823a37834932cdc9b8caac0ad87a8c0893adc2d4bb31eb9d397e4b0a1af3faee21b1ee2d4d34793b4dabedd63a10edb1866ac283d5c4247db57afd8ad5e9e0bdf70f67ada5e5f10c0ef4e66b0daaf20acd58b567d4fe3e8e75e234d0657155087ed2153cb165ea2932d3297eec44b1b1a6d740d65cd5427e42fd26066b2dd84b97930130dafd28a874731fcf17548faf109ac6fb189e88a7fc62ad8cb59a4817a07d28c7675a170840f167c97581455030cc349e928a2d984192cae8699717183d801009c0f8ffafc52d46fc8f32610c2491d7cc86b2e705bd49b8c9f9a924ef8c115790954143a0a97ab6f0be6fd5bba704f74ceb01692f095a40d959cee5051f1058f059434a7bc8b49443dd1fdf6f0b6eafb9924f7315eba2a9c4a1262864de6706a842460f538f17b87f3d13cd22e2d3a1cd8d0a4e648acccbf44b0369f1e7e27929b70dd26041a28f3e2269aa97d057b8fe4435da860ec5a0e28749a8d9c85d84b3fee2aa9228eb3e050543dc7b34f752a9dc72a9232989dac5ca8859ff93f903aebd71dd3400774eb3b97bd49eddc218e6b4795f1c0487b6daddbb9d693c1456511eea23ce9f4f5f3c01568267387707ca59ea51c6ee62b713055e6e26110e1e78fd7fe5709e72a3402a31cd7206b9eac3672290e33cd47b9735cf2685074d13fdc09b5313ed22b1726bf65de7b7cb135a2d097466ae32732a38b9b0d9d99763100090fc14283a5feb79aee4c5b29d201bcc68c25b47d27de351e3e7b6460ec10aae15aab1cede5659705ca310013cff040a090c31b354886eb5a5d472e9397fc7ee018180c07b31a455b461a7df8d4947e4b6c16bdf91bdc11f37b527ef890c77a329424b88875826373f7aef21bd3a419162d368578b9b887c6ce4bac269728a2e06e6248013b5b0ecb7f899b8ebd8c987b6798bdaf0c8f74d3298e6326b4252fec35109526a3da228a1243b512f587b7df0a402f4769627cd61fa18b44e99b7e8328bc654baec7b725856ab52a8668020a5ef5f337a201120517b1c7095f8cb935722acd005ce078fcb1c56eb56c35fc5ee2a116bee2f814f4c68ddb551db3bf77aba60f3e726c1dafb65ff099b6302d92170b314a280622dc90e58bf97f9197eaa1ff510bf9fe963e41088b22249b69f7eab234c563e373ee9e199c855fbf2f05e04def184f322224362ba677d77c60b8a312cb30359ddb08aadc350280d58d297c3032810a62819b9ddee79b150d0d2a0563bcd996af2ea85a5c6c7bad6851db33d763b5d4a24d085132d238472559f9f3142e0d3f41f27d3ff92e1aa484eb2d8fac40d32752e8186641aa54b349bdc98167503ca8418a1359d7b381e3ea162dbf175d77dfadcb039fce2cbbffecf483087f5d322998621c1da8db2937c9007c2c8cf37560a957635e0bef1a52594993271ba986fff55d1b92df6743cb650df4da5b11f463907f8f1d41aec1b94247a9fd1f4a3237df9b4ecac09079296f73a697aec4cc8668cd4966c33b7d8e242404f9722c9777cac41e1a4404f0e4b782478a9dbec1e844ee1bfd043322ecd7a6c56e95fb8c2610c0ff1bf7033bf9d7d28d68ae87ba50c60c72f10a08f888ff6982f44d1eb212c1c166be3273d02e90b0182c7ed2342f3a228fe1cdbd555f32eb048ea5ac8827a6bcc381c2fc5511b5b0f2ca34c4595d33134f6825a5894782a29337d1d38613af918acec8d33afbc5f68e2b5ff41ea91891ca6c31328269962cff413f6ee647c9d9e8068a26205941bbcd9c043f4872b3a0ae14fca571f7d65d892253413ec7b803f32b1b24ce5209b13bf7593f5275d262604b360f141db4ae6735c25245fcc8cbdfddc7a287aabba73f28da926ea923c7940f6fba99b1648baa6bbbbb4c135655d15b94fb05b29f689c046b4d6ba84a9934d34b6cee724b213aafb1f361e5c1a0e0dff0f3b42ef94ff25726f15aae00867ceb5a0d547caab1ae8945b4dadf7d762f50e0bf9bcae001d2297ed72f86c24c56634420eb382f127b7547a35e79e50694f98eee7d6d7611396e2f197a74cb648c75a4697729d016bfc26313047a74ce2a46178711bff1b2b0f7fa74c2df9a9fda05c28f891a0a14cde7d69410a97749996090323a7d41e27904304f25b084eb2c8a457147a20cb10af28d76e12a45beaf818de84d45f06c5f510e407ded76dba4b55f824cd439623334a538595316d10a52947bbd0d073d0971eb85d046983916ab492fe0b233b0a25b3f71b73624ee39e8c84ac352f7ff325c4f9c245a035c2c86eb3e992d3f6e67d76d90aa685bae50f4400c89c596db58ed05a098add15dbf913b73d688ca7f91bfe3038a521fb5cc14e48ce1de88af330d2ee5e22906b5057677b3bf5755f768d6a956783bbeab286636c6c135bf8075ffa1bbafa72a82cdd93efe120b09dc1a0c0448c9b2f22c6f46b07ac534f83c742dae6557cc53f19ff7967a3ba0c7e318c3959518231dc4149fa7d327db8426067114275a13258201a17eb8d07172570121984c34a95238a3119ca6de5c1eff9766e90710bc1203d5b5fe7f2928e231cd4c1c521b6a7f97aa711f5c0142512dfd4d4f97e1bf8eb500b06da013b984ad89060f52b1489e22f0cae9c2ec3916cd4e79c4a4c86270ce1f7ad4c526d7007a0450a4601332a311a1acda86f1f0ed04652aea6636cf892f0a95727e47c84f841512ae3e6b3d93217618463ede2bbda5d66c0c9ebd510540bfb17081eaded10af0c590565b7a577c04591afdf2b4dba18c1c94e836b576f3dc09f00e325d54a52af209590711d80ccbc7afe1a38328273d5b5cf3f65ec574e4c9059136c9f29a8221bcc23387ec245787c93a216f8432f1186bde334bf1869ab3a6743c75b3e772868c07aae5d465456c6a9841c7ef4ae6a0a504f214cf8f2fc3a5599a9a748e67886fccf2fc552c00a86d21db7500e5de67f8049f0a3f396129325ce6091e458234cc475c9b98bfb0d2e6f2bdb8bc113d9d9cd68b097fdb06376fe9a9e7840ba04ee3f11db8c42cf1284a21b0d3ea0bb85c8c43f762585773ebedbac340fabcfffbe55cecb2c42a99a88d95df2ab61e8489421a4596ec0cd070f0d0577521fe15144fc50373e97303d4d6bd087224c9d7f22f7be522efe07e91aa8f1f4c609f26a74b53565591f27c8b3ba4f33b0dff8183b96a63525bf157b2fd4b00e10c749facc906b3b6d8afdd0fa9d1150647a933fac2d33c6c502ee5244b906ddf3f47179302873b7e586c7482a6faad2e5c1646565e81f4a5cce840dca3b9a41258655a46701c4798119c6244003b3a3c14b30058366c10250f89cca52fb16822527fd50a75d668d7ec7348e37ff96073f732ee440622ee7f23048aeebcc79a8253dfb8689d0b35e2ef217eb0f92ce1e7656f0e0bd263095b6931fa86095957e611c4a43341375f913ec2aa7c3d26f9701ad4511d4bc6867a7b610ac8093303a1021a395ca09d0796752760de424371265971f2adae90d2d5bf316522c982bdb812bccb070da24d95891aa409546a8afc2a8d83116d80c92a6884d42f59e08bcb86f098a90582a23078aaf12b6bb6be59ca8cd4a79d09bf24e5a580f6a24ce085c6f0bbc0c55ef470aaa800ffcef6d9c9b21105d668f1e936585ae09bae96a72c50add93b1aeff23a144c4fec1fa9d00aab4689949a57205bad9e362786a3fbc9075eaf7fe545305777927084ba29829226752159838ccc18d23ff394c6aca658de100cd9ccf6178876efd23445c4e2eced5de6c9772e7aa4e4bd33ed2196325547bc6bfc582ba4c87c3d489e652c2d2d41f64498f8813facb3cb98762e88c48275b28171c6c10d2adfa8d6bb7585f3256271ec140e8ad22728de1a21a47cf8fc1a0549c0f50f1d5a6276e9b09196477290a47b329703b2be9a192cf8c690d33154847258b448343290386d16cff4bd2f3c2fee686c02fb6c0a41e9788872c4829dbac9addf3cce4169a847d9c41e9653d31ff383b1d508e8e7bff730c49664117b3b155be70a9d9f97a32039c287b3b5d69efd2f83e400aff695aa6d997d56f5226ea349058a8235f38348bbe069cc77ae8ecbb8c204de7b4cb8fe432dd51cf10bfca81d4b7029adcca877314540b9c6fd09134090a5081c7ad942aa8d630501abcb5f9c08d90b231987fa404e2c4761621d3ae7493764acf1ccc6118c81ee97bc6d2483d9a86271eac8bda6aeea646ec4600b89a0fea63c40ec09b86e44eb60d510c48b812ef97336cec8378cde99ae1dd7e873dd96a40ab33d0165af7d4c5a0bb2da561d8f9c32ebbfa33f5c3fbaed1dec2d7d30d8f88b3c8e8e927bb753aacc1d776c875eeda4dbe084cd04f9013938c3962f7282a9594825ca6e78f51d9a9876124ec0afbc4acb65e85e227df9cfed646416170ad3b7664ef2f73e09f5a19a19d1a2888ac9ae82ce519b1ab29744d2f60197ef139c49ff1993e057505e94fc40b3669c5d1a5c2133108cdc330a0e6593c1e1c01ba78b9306d4907471b1d4a7948072e892924a51a2983c7a829a70c9e183034f04671fe04315b4fcd9e59fee8b5eebc97edc6d401768a05a9132355fe35754d78012f4188c1cca3b1b5636c8990c74e14c43fed4b3f519ce81c3af25fb22a3833c49bd12ade38035cda39e8d080c92a088162d52545cf1a2efe3749cb56a7a6eaa1efce3c26ec11dde1b9addcdb84b2a3f2e2439155ee785979fa1229522feea45f23c18120b515aba8ac141fa308e8aed158924bcd7b6f9add21cbb744072be7a9afedc871cd0b9387754b6678a11c24f391a4e7a3e853cfa37048f1e06aa1378d6ef7e62ab32a1e56076852062bddf31acdeaeb783bd870b767de4543b3b04f7e94adb1fc84a396c320951dc4d356bc687f0bec7c0fe8565cc98f39fcb569dc2a8fd792da690fffa4439b6900d680a30690da21037a3354783b4750292c975ed3a1349bb24f7f8036efeb28c29fc5e909dbb456ff637a75e940f2b18a0bf9ed016a29fbce13bb40dd0db0de3c0335a3b4fffbe713d2b2b986f9117605329ac7c96980368845317a3d35c2f1bfbd5f51298d248b4a9f6f42a300f09a80ae8dc0fa70684c0e6fc2f289493a8b0242eb45104f57f9da3f901b7a712e01c040956aac9935cb1849df050c131d51eb4aff77c01f34654be68912a59ce5648062ac81d4dce5521edfda6bad0b720bf1fc1bdba07126465866e6c72b47ace35326e1139d9a432555359e966242f564a2b8892d280cd047f3d142e1c529d405dcf80472033cc2384338044789c14dd698e2fd410a30c2caf34deb6cd996e4d1c4e72213c242884421dcc08493a30088c2077254d0c7040adc26247e1081bac4bcfafdd08a9701355ebfb544107ec9fffd3b489b4472206b508cd2e7d4234bdcc5e0efb7a95c9d8a41eaf3a2e99e88bfce2941a249483d5ecc985d0f0abe33092ae815c4b7ceb2c00215292c673d3315ed3f10fb5aeab18b40afb970f96d1ae57817b501334cdb623c42e9997ad4b98f17f8076c4572a561d5bbb987e2edca9a2fc94f9fd46ab135b945b20c96dd2f0652a67a9a82131f6a3aaabde82f9fec9082d397eaa5fb14d52dc81d0b23446062b482d196a15bd4eae5901bd783a0bee6adef285736808eadd2829e623443e02857cd10bc87ca2da8c4e4472822413dbd6920823427cdf7d69494228b47deb0b255dcf2f99275f32c5acacb8a8d7f1239242445d51c315796f82662851d44c9904c6b382b3e9989b15f806f52aa93693edd83d9f2163542b9a0dcef55b440a82b7288f1f2bde1e5bdc40c6f482cbc5e9091e94cb98ccd41419d362f806ba781f898ef6fbb23d9d113abb2fe15f6cc2d10b73f7a48efe4c4be009823c3d0df21e0932e5f7b85956f1ca4f75520e30603740644cf8c310ee4f3ab1011797d541facf318fde670facff6bd17c1b8238ee023543a688fe109907d8243b34a6c18aedaebf3647bb911871f76880a7aec6024246287055c4c8d8efcf758735e8905f3838383f83c3b49f204c96f81feac51b4c46a068b30d1400a9a2022fd094984db59fb55cba771c74e59e8877aaa51395ba6f931206909bfa99427b30d2b3cb80e6a1a064612ad6759ea57d23d7a224709ae79d9bcdc94a290bdf7e6f216764bc38ae049dd914f223ff91005f852ca87cdd5f9e44f13c777153316556be09d432a7c4109c37becbfdb81ccafb1fae145f82d461f2e4adeea3f589edf0b8b999425b7573a1e32e9cdf0ca779494cb5ed506bd216f62005201f96e2856ad45a4f293c5d0dd3cae3cecd19bbae9c8ddc4b163103395848630f4f8046df7167185e751a84578c43be23b3bedacc6a319706deeffff49b7de414c76a56daa79f51a7460aab4164735cd15657ea83855cc66c2a7b9ebdc5fa91daf56fd2d1c6b230f92dcad79b51f2f3bd97bfef7d1733df993243edfc33bb644343050a6fb417f29dc6366edc711d3c09e21fddcd17f94095876801ef53ff1b453a12529fd73e45970ef0162e56629eda99809b40ed095d3e6e8f8dbf7b383c6bd20292a6201d50409de593cb5e2ce3b93d1d273e367804e9df80908620ecb7588da3d77ab8eb1a311975661215edda6b62063277f190304120a32b203a5d65093722979a3cb6447ab3ce8eb72ba688af9577d1c0bad1490e7d2b4868d06ced84691e57ffbabad4fd925f91f05a9da87d91d170bada8baef11f14606fc17173cdc1ee5fb773ddf458fc1daa49439ccf2075806aa30bce00ac2ee4e5b5e0c5ff659f197b2f53d7a066d4c82b4c55a23fa06adf2932184ad8e058d74ee8b43f524c18f058b096347a37f5db548623871f8d4f34bc2ce02122d0fe688a42cca1dec774689a87c5ccaca3af142581ee281cc83b9f35f3b8c9a95978c3fb977009f05e039ae6ebf6d26b3479a9db68a1e2dbe6d6981820662815d818241c95171505060cc707939c7eeee0b1e098958cace34f660cc39367458f98856f4fcc4cea9ada3ce60aeb2110b95ec7c30241582d15ce0bbf97c936373f3750b831c3dc02fab5e8e9bd1688cc66599cab49c6647f020aa57423b4bd3ba5c92206a95e1a4b700dd220e72b308b77889783403b8906a3a52544eeb719be149bff4d8a43951e4b7ddd8e382df8b9bade599dfbc90f11b58f2bab217123a648293c2f1205de97bac688ba0c5cede7d58979fb28109ece79af1856bd765ebd93a057dcdfb79e8d5dda4cf57321ec886f5a2e6bb78a26837d2869c2818abd82a557e94ddd8f6a8e0de97723e96e8f8e39323dcebd56e35e42d16c51f7164df81d5589f16436f7b66b83fbd63758c05ff6955a2285a76aece276a82e8029eaaf47c9fa6c6f42f4eb97e38c05a10ee6e62a9748c84f32ab2a7e42c70b354f189da9d3f7c120b64de9c20130e76bbd5a97bbc5c28021ad6a8fec75c8c59a1a37b30b98e55f886219fb8c9b1ae46bf034f3842d37ecfe19fa5d16b3a80edfe142dcd56e68e8e1a2d70a04db236c4b37e0e3e24aa347df244d1542bc5ad63783795ec866f8d2a9727c08a04007f42a01fecb395701f364c4dca405c29b1d2270e2571f0b0c776d330dbb62f15c86aa65e08fcff9063b4adae7e2b47ace51c6d1df93722bf2c8e2c684350f87695cfbe384c56274a4a57119af3d6ca5a29b705238c5b9a76837ddeb7b698daf053bf4b6d643ec386150634ae0dc6412df0c0034754f05568d2c47868992788a43f9183ac2c1fcbefb1826c1de28af56a66e4eefd7fbbd68d2bc2f52e09fa86e9965569979d2b0304f9f507fba053d13a1e9b78b9ac209562eb071ac502053132ae9e6add995fd485afd26a3b7328bcb506d0fcdfde21ded9bb8dddf28a1a9dcbf45e71aa4826afe8df067d81e5c30e8e1156f94d7b8453c10026ca29296c8a62cdd64fe386b836645cd98b8cad97c0666561b3b206ebb1cdeef0bc6bc8a6689157af90b39adbc7f09792d87bd16c7444ff104a0caa19af0f03ba88fce3868aa7fd8184a0c4d77f990614c0247ba2d93832a7043f32026503e803c52dccc5187a0e531ea96aee8843b9aab683358d8ff3e0a1c9a8792297f20711dc13177b0019b06da366f561eade1c6b529b55b9cfdf69fe6ec9362015306ace838c337a9ff2ce5db8ab03aa4d613ce1465179eb9c6c5ef7f42bb9f6bf962a612265eb17997de54f1cd850a77b240e9ac5a3a9ddf10c9400cb5279906ded9229639124d67942d8dc7a701883c63e7edf6ee3ccda48b69eb309ffb0bbb88d1f83cffedb611ab760927df89afcfd4cb8a373775201972393a66522b018121790a06dc98241286574fef1d5ed10db134628bd1da8cf703f07256bf6c731debf7f0d19c856cb4b92cb67ec5bccd40d21a47c58e4a9478aeaae4516c2c949480b6c48d43c529e987b04b7c57d250b19a9c2fb79322c059b0e53742ea1959bf5cca70d1a796e6ec8fbd12bd9079caa4d31befc29caef69db4740a5b698d6e0308d30e1f445b8c85132e6b9ad2b730b4146dc8a0fb7ab134219f5a67cbfefc6f9a4fe626200a0993aa065943b9ca8000c3b7551389fc091d40041ffa892c53d78f3847691c236146ed47dec80c29cf177a938f4bd331530ebbfe88f80591259d4f0a157c8b5826d6beab78df47d5d3328587296fd78856553e5b37e85b3a1c55a97247e6b3f97773d7d139579eb705832e188bddc2b9e8ccbdf5b06d2768e63fa0d0fe8c1aa90d544746f7c631430d29a77485d401cd4f03fa73071a1d4d74a3f1d46a4b88a992cd3f45e75ffe0eea4fd58762f1568434fd4047f024187cb6490b68205368460075fbfc24e29b056989b3c915b80010d3b21d4c070c2d3f6ac9628face1d7526b0ba8bd36940b9eb6de57d33c783d0e1717c7f2af12a9fbf4f8915372914b23e3db5a71fa4069a8c04a100a2ccc967205b40e559b4796dd034c7c53c6e2c59679e2be10e1df99caa0f8d96b9f4cfe40f88e897767a511c42ebc77ca7ef66597ffc782b194bed6237ad840d24c0f5a52fe2f52bd7610675167d460c1bd2189ac91cc69b65b26d5b2fad7fd47253d907ee5f1c7bbd2d2d9aae2cf7124bfe19ce00dd44d2512ea86880b28cdb137fe2edcfdade09f065f1f6c3c9dc1fe62def9252d16f4897809fe6172c9208aaaf703dd6095b0be72e14609db4d81b805c3299caa07aa2396c7bf2a77cdade0e071b8bd904162cc075d934997067d4a414eb0879eaeda3cb9c2399006126f3007757ef4bbab68dcd8dc040beb848352b320671295d4a657b8733fbf933348dd569a0c817066cf6ed4be7af57acec884ff1ceb3394d20eaf2d15d8128968827ed48caa1102561c7a452e41e8b67d121f599d71a2e0c59dd8f4e55d7e2a691a3942e5211dd0015bbaedd54241012d1a9a3bbe8c489f78c883d5daee3b57536900b430bad1b7e2ef2e2612b4c2fc7c44b4971244d7bfab8065743fb067341f4b95553fb4e54a6de899b68e8055e330d76ed88737e74e66bf1eff6b4a69b6c726f3f344f7a567796eaf4de5a2fcabc52ed7237676c3d58ab99f3435092a8d2e66eb9c3ba056331e3760dd5a2e5a411e74c70204ed7da999f80e2ce75e943781e90571f59ec46d63d8d7c962edf06a591442ca685b665d5714c10b25522fc366c67e517119a5fae24e33a56285222c53461ced58e1ff4c753c691733ebdb8806d527d60a4641c975970d206caa4065a59db2b9c577c8af23e5ce27eb9b1a3a121f8dc923b63af452387e94c0cb35acb2e79be035df4eeebc3314637e2c4a23fa82bd36d6824470049d9733565419383aa63fc6804c2c36cd9ca38b8317d69384dc5c783e474ba95b9bf16da5f32843ad12de273abc0a82603163ddc4978623973e46033ed6bbeb4800cd05c0e3062b481e8edbb165c66fc83f01b966c987f8b85a602ef76c816aae6e3389f5703b77c823aedb0897f57cd801ac16d67ec47d7a8c3089658481ed9710b0d1375efeddc51c94070d3db010bdaa7e6c4797a85413778675651af7963103961eeae9612911624628d79d77f096b208f2e598e80a01f735188fa14f6d27fc25773c205be096d4fe0270c571e4fb664528707e164be3d33034773249ebafbac13a6daf5ee8efff3d98d25e756b10d40787f08c01d2a8fc844374a6ae7706fa82b07840f0e056c33ed6c108aabfa26c1cc2f3c0ff6edd36b816ca8cf7fe400bde36b13a0b388c3a10315ec54da862d60f6de1ff599d9a14232a6448bcd3a88a335da403ff597dc0c7322f5458ca492c39c9ab1a5e8fbd3cc7009c0a8eb56bc3e561cb4123d41b4a97ffd674e11f028bc43e80094f0fa7226c6efb811eb13f9201bdc1e28e35d2c421068d72c2002d30d218085221e5d7bccfe4a78436c3828828daba2457a00a28978b83b8a853206bb19c89865a84564b1cc33c345b3ebb7c1e45dd2f358fe7db0b9a671ecc2f53664716c645e48e272044d4a68d157e66a09ec88d5cd37fd2fc96d40fa108228b251751fe9f6edecb9c2f8dc2f022e076edd0bd32d7ff6e2745ef16ea4ab2ce4eb14a31c3e935627567bcdd731c5b7be34473ede044fe598376b10534f738d639c92f637464da4d7608ccfd3b96b42df56a2cc689edf562a4cfdd858680f4db730b2964ef31de734d8f8e4275dfb7ef85941b2de0531466d5fbe5db51bb6b04419df03340a6ae7c672a884333fa2ac173a3d62397696f6d218f433ccd2dac3ef35b1e2dee6854a161df277d30929fdf2aa0f46adc6271269f4cd6581a0f8be5bd198a1b1d6eb210638686362f3a91acc1a94ac68cdd9683431b759c0ab2b8cac40dcb2780d385bbb09b69243bf210c9aa6e9aa6f072a43952fce28c988fa33d2ee3ab802484aafcb9fbc578e305db20055827150742504ec45bf45506b5e80fb7e58fdacd360e7ae2a357d67a2a0874307a9a46283aa981b55a9a23fb7e2eb8164aa56b40738a72cbaec032151e51011f8c32d459328ce670d72de2950624e87eefd0d4c2269e0547a0427a74f383a83e20e1a752ba7018e76edf0000d732146eedee2a224086f80c2bf530e22cab09e9ceb6747764b5a2c9ae5073000c1edc0557c4225188cb0f013a60c25fc78afd2fedd573b6c46808dc0f1792a99e78a4a4edabe065e04ffe71cae3f7fa5e394573207f79f73358c123600ffa5a865950408667dd53fa6f07e8ad8107b144950305bf25400cbadf964f950f2ccf86218808a03a3bfd5d801c9ffdeddbbd3fa1787c05a7bfff26bc327e5b69d3a0c5600639c6a66fac3c3e5996069ec8f7a841c15d8dd150624405f48052bf9576fd4e9369b5ef0c3138036c89be5ed4297ae6e7af379c3160d7d656011d8f062cef86c5d7978e5cd13ce246f99eacf4c6eb7b690724b75ea1c101a1e5d1cdf45010869771b588353beb97739b799017dce5461bc74a68bfe9ea509551d8502ece7769901ecc8d49e5d254d2faeb7494cd0d08f3f367d4f7b3ab2d004e1eb435c57b3be79433bb69f60cbbcc7cbb305ffd93af03554959846015fe3857497005302c1439e34287c4d0d86eb4d4b62c1501261630a55e76ae2d4667e427cb40ab0aae9a3f3e46862e1bf05df8d528cd73680ab3ee957a4d4f80fd684a9260ee802d8a1e84981f2223391122eb6658dde6fa2efea763a7d42c87bfe550e25d417f9f95e6740076b07b06d0435063ad1d678d474cf695d3d22b9a3483ef87ae7595f5e435af02de3d5c3a59ca8c47ab6a3be310adefd1460f4aae4acad31f28c9610e186427dd1045805b706606078e9fdf765338ebacd2cda6d8174dc4cab054147ea303d0dc3268bf00e3ab030b2eb29e8a6ea635d7aa8115ef84ea5bd1aa0e7eb5b6e06db7f7a711908c95ebbf85de5872c366693bb40c65b63df3f38c4882f1a97ece99092320388a54d03a9b0ed875bbd152c1667ee7dc49b72e2b3dcd8eafff48239dcaaf7d2405d2d836d6a071e7e4d76acf49564430b637250f7a8a359d7ea0a054adf560fb267a4c562968eb49c9e18a29ea168d5d0a525cb05eb70d4589f400ce074949551dc062a2d2ddbca918b9de6ad0b68445eda890ad2b81f7ecebb381b78c0b34413d602168a5b4e0a10f6ccb496c4d6302e50d0b247da32d2c33ede7efd51ea383e1f28fe58b622078c3a660ed37b4322e6f3721194e9e9fea2ae5b4a5173c924e61390aefef25cb4c1e02f321ded16838eb9ccff046c7c13c55134effe24cb375b782d7b6096b651c1f0863ae0d48c9cf27fc2d5e135afebc4b816792ae4e19e360dd9c646e9c70759bbdac51531bf67c07b5d8876f1ed3dde5227ea8b19bd766dfe02ea3d3d28a2084bcfac040fd3f50d592704b9c915d3ae2b701d79e69600e365b126fb4ca0b9e973ddb8c510ec9b06e8f951a9bfa8cbe946174931879a69afb916f4811f4bc3e293e3a9fdda5dbc5fa35654581d6a19807bc17426e61ff9dbfadf3612eda7c98c9fad84d0a18ce668429a6f538afd8b2a949d4399e71d4ce56d5165e3e2c3a2c30f49ce388cc04995419cc370b40a3ece8a09e37f5014b7488c3b7e3a8bf5605a28c58740a464b5c4d0b20117854c9df60197dca0ff112377ba82c7189763f6a155f962b5d5e23c7bc8354053c7643e1b1d9ebf7a7426403ee53a0dc7d4d792ff41c290fd64e417a4930829d803deb4a9fe14eb7afdb35050148d397e7d3511fa50d5c980b6905ee9f16b054b6dbc40144f1ca031bc09048bdf19d7f1c118a0e271a5d3369a2de4ebe7bebd4a1356a2b84c70b2213156cff2372eb721d1866e9db12c920195a242afd89b319980572c003ba4c03495d8bd879a6c2397f0c48fb34b723724c18ec17c03e67b48e26ab24cfcceec3c287cb2d8eb1cedab85947d80d53aec6a5a8a58a6fec8f381bd4e72e83789b57a77e365293d441df91b63c49fc48b1a635fddb21d90aa9c2e16c5b795f96cd76ff66ea18c1afb039ff9aa3ff735b6e470854a91de37aa1b1cb718d1698f99224f3c9736692786dde89ba80f8c9c50b0e26dd13dd52daf4e2f1cd73216997ad9c9cd3de2cfa851797126a948f6fc4174096e7fb15fb35c1ebf8e39d8e7192eedbf77ff426fbb60e58dd53c4cdb92e013457a3be1b9683db836a9f5a0aa05aa33da55c1aaee9f4c9e5d9805ac7cf03faafa5dd946202372eba70757746f878a53fe33848007b5800cef78ec0fa3d71dfd45e352cf80f641fcaed7abe0c577008f5c73180f4ac203df804535b4f01d99635ec9bd67c881314952a813842452ab6789bfdb138eb74aef32a88c7715aaff40a82b6fba8d946eab86361664aee2a441412cca3a2fdd03d6bfba6e27147f4286d0fa874d15f9537f9234fc48c095870e5234708c1c188dfeec564827f46121ee2b3ca7b346a4bc9e9d2210a1f2d842024bf7045ad5e78da0a20ee8f32a2ca8a08acf3fc34ec00745b3fbbea6ceeed1ea0ad28b7dfb6e51a7e78d0355cd995b014f542b21f434ce3faa61647ba6a1d02f1ad08d94dde86","isRememberEnabled":true,"rememberDurationInDays":1,"staticryptSaltUniqueVariableName":"ab7e469948e4989d322e29867cb59cf1"};

            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                if (!isSuccessful) {
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
