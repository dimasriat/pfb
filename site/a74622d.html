<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            * { box-sizing: border-box; }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                max-width: 768px;
                margin: 0 auto;
                padding: 16px;
                font-size: 18px;
                line-height: 1.6;
                height: 100%;
            }

            .staticrypt-content {
                height: 100%;
            }

            .staticrypt-page {
                padding-top: 20%;
            }

            .staticrypt-title {
                font-size: 1.5em;
                font-weight: bold;
                margin: 0 0 0.5em 0;
            }

            .staticrypt-instructions {
                margin-bottom: 1em;
            }

            .staticrypt-hr {
                border: 0;
                border-top: 1px solid black;
                margin: 1em 0;
            }

            .staticrypt-password-container {
                position: relative;
                margin-bottom: 1em;
            }

            .staticrypt-form input[type="password"],
            .staticrypt-form input[type="text"] {
                width: 100%;
                padding: 8px;
                font-size: 18px;
                border: 1px solid black;
                background: inherit;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                width: 20px;
                opacity: 60%;
                padding: 10px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
            }

            .staticrypt-decrypt-button {
                padding: 8px 16px;
                font-size: 18px;
                border: 1px solid black;
                background: white;
                color: black;
                cursor: pointer;
            }

            .staticrypt-decrypt-button:hover {
                background: black;
                color: white;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                animation: spinner-border 0.75s linear infinite;
            }

            @keyframes spinner-border {
                100% { transform: rotate(360deg); }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"d208d4bed3ea9a91a4060beb94fb61a567464209a47f27f42cbb70b58d82f29e1f281aaaa99870d5829d48fcd42b7c05c8154edee184388e9fb17ed380a367e29417d7db58ce20331af08deee1fcb38f34cf15a4acfd79b194c93fabb44fada52906c4df2b468e76212c432e8e2072c22521b905bdfa5d0bbeb870ccf85451fae04769d5ee6541d32c4f42c458f26ffc13a80d8cf1ec1c642e3cf1e6f4d4c9dc6e4b8ff1961cea3056fe792dd2438c3d44056dc3ab2c186835429d4811601654d1c2b492cb70489dedafaf6b533bba9a8581fc98e156d26a410a4ae365812eb86ea1747f42988826b8a50f6b5bf174e3736b388a34292b4b8035cf1f4052650ded1f074eb6cba897c3424bdacda0d3c2d51c7e741393ca6524e3a1de908a66331c63a0693b0fe15b02d52d10e42bbde74f25f9b0abc4b9e07f85208ce1759ebdf83dc619cf564852c0b2f6e8f95bed585bda888f8ca8d6567f4c6abb082b20a4447f37fc9956c7009041de96ff97e93717d36ece178e493a094c6556c93e1a3417c49d06fc6a0800633d5cf2553273dc472e5a279d8d63555a7fdf0ffae1a5ac61900132301a7abcaa63cce647a4a2ab10e914c3a13d1a51e4372b35c02574fe22271906d92c487797d534dea34785faa1985517292052a1d240d0c968e4cffa9fc91d4da3d4c85d65b87b66a58e92697af05073a9f62d8413fe4f6ab2bb3913b1a320dfcc18e376f2e820712c9f9fa8f4bc25fe061bf0abe57ebf1f3843430869f6df42f0792381f272ad7790a331b07a0f62b1436696c4fea521145b7216f4df90ad84f0193212b17a758317cdee64d3f679da1c7ae6a308b3e25b158ae756b0dac5d0c8c36bf94ed9ca28e357c76a004fced98dcf70cddd5e912450a990d6ce80370c718f27e0e9651d03166c2b53363717ae87c865128e09c82b72328d78d6918e37bf3a0c027483d50a0e1b6be391ca47034477a519fbb4d6043adc1a1020f914f34d25dc673f55811735506af78d59840f925088d1bf6d922ccf24005edcaf84b039fec8776f1a42884f466b1c92514054195549a95a7f53c065bfccd833539d065c44392337734df710d4f40d718c69dbf73626e76887ed0867a361f5b0164a5b4ff9dfe1b4d4b007e333ba709d180941b08bcb9014b2c882fa6c4d6575c90ef4c394bcd94c0a906680b11daaaff027433f025f9bb14b5fa8492b661fdb7bee66c3e3ee6094b8cdaa324fc4e7091091c61c4d0c4f88f992dae6a554323dad3f07c2cd375e6344eabd9d4ba9eab8c1a11bdbaee33f83d6c7f605938ec658c508a973e231b4324faeb6b964f87483f4d4deb536e60ce76366f9fd416cfece2c44a3d1c8f281f594dc5859cdf59f453c82f70153bd67dd797c562e56468e8942a4eb5e047819a23166ade50cdbd09fa2c9e19bb49a4e4f118b54241197c6899193988fa1a49d2dcc43f9191c736323d77e9eef5065c1d617ec3550e7cecc407e6c1a878014420c56fd731224e5a6e8d2a6e2ada7f7bdb89d3f2e038a65e162571d575460c0e6bf2afd8b9bc0209ab5d21e1fcd93b63816a208751c24baf4ad76086e7a18ad0a60abaf9965623c0e82a01a40f8904596c24c9169fb2bc12d6abd48974a5a46ab6a3014735a0e193cfeba287ae733cadd4f2f5c130c0b2aa20a52fa3ccc57f7dc5f344b7472528d5bf9e210533b7ea385909693894116e18a30734bf66ab1e26d3fa5683aa82c6c127b248afda705ac105865dfa625fd3b91e94d0664b6ce85be179173a8f3b3ec8f3c9e4ff0690fa80bd924d474a209cf9f3a3832f4ba078aedd60eca23fe49261b4107cab387aed99b517d5d847f237fa98bfd09d836d79bda48ce4f1bcd8e84708f8d0c8b946d3aa0c56e17042295b1a70dd07a27f48cb684875883407730c15717d6d54da1884e84d3e28598c0aea1a3eb21f26472c747c90ec7c7a5100882e86f5bbb8955745cb5fbdd09e23539c934ffd3f3356eb8c2f6829b9e6e8e0f86810e1d9c8a1303db9c0e727f83cc73819582b4db2655da5f56cc21ce826eb273c701acb8eff3a64aa3f09710726d53591428f4c3a771c80ecd718ccbebdb943d634cd40f40681033e26170f0885eda24f57e399182c8a111d04b12f6578b4046c51a5e992a42083e17710136f1d814a3ff6827d97dc13939a2e75d293320957c3d6aaf19b5073122e51f29e515b2caf6792d06c296b30b2a66a4acb951a69331a885e84147ae95855270633f4b3475c484a34fb91e16e24c6565a7eb7d0ef5fa35ccc9bd5d82f643b169813065592d63b2fd056bc6f121865a1a18425283e139be8e51c6f11ed14ea78675414551f7efca0563097a8d24062708f5d355e3e4714fcb45ade78919d5cf4cb6889a5b02288e4854eef5cb630f4e3ab6f4c80f43f196a9c5de2bf3fb3dd0a13bc1501ca627a0d1627b808030fa31495cbfa48fafe8a8de2b9f745030fe6278bc957a3d217ed91fd5e3cb0ed91fb7a6c5ab310a1fa6c859f1b235b28cbf429db7aba9c2814dbe808c833f62818f1ea07ec183ec9ac547be8df031ffd5d9cbb67b5ac0932adc27db43bee9f5249dde6a2baaa41b308236c14e170649d56e4c9f82909932ee2be88d80d80fa088e45dc08224d2c369c8331e856314ce999072b62918c40f232ca0cc17303346f7936ef7b269b9c6263225544d4198c74dbea15d8c54091ba6e8616f4004527ec86a599f2fed3a568d8afa2c82cd6187e1acffce92cdb9388fc378a62c1ee4fb0a398241039cec961bf703076676880d994fee2ff80bedbf0ce315cf1e4e337507fbaa06592cfdd775d69aa40b700105df672f6b7850a25aff7f687c8c8219098e707760bd2c89706897b0def2551bd355a4df626366686f7b55d442c55425c0be5a4de886f9a9d3681ccc7841264f2ffe584e263448abb645cf6b96f46b87d7ef511652b25e1c6620cdc77b98f48cf1ceb0e10033ff63d2e90e60f713396787e3bc875d8ab12b7629c92db8f146713eb34dc83270dc75182eac1fb497a3bf1371790ba8e14bff99bac24763f32e384482451fa28f36f72f1fad61f761fa8d69ffd12f218c385d1290056b74a933486632ab0a5770ca79d194b8d98ce02ab52eac2053309cf7220b000e1369b1587c3158c0e9cb34671af51518fc24857e6bf4598ae7e862a6c5b64351d9f59b9a59fe4774f4d485da3363a71cdfe8091a7513d3e696688aaec81b26e6ba7be2df296529990394766ea177bdb7e2f33d987d13fcadbf93c1093d775c1a186288d217c738901184cc24548edd5c947601b211a0f8791ab89a0dd3a24fbeb8717f7ac0b7811281fbb835b487169b61398e69c85fb574560ef704f8fa60f39ca9fdcd17147e6b681ad003678588b9196fa3f0ad589e42035103584b3830d9bf3a10068de6597df2a4632f096915e1c101deebf3b4b212097925f15a80148699ff83d76c7ac5ab7278bcedf879f64a53e93fc9072278d5abccb4eaffdb73c7500680ed147bc3ff4fe8166f90c8484fcd3f0df28d6a942bd50a67f47e4dd62aedd080b43b4dfd8ba1740281a194439f919ded532b5d1369fc97745e7fd9c22cfea75c4efd777ced0bc34fcbc82c91a91400bdf0f9ae16ed2cd7bacd040dc0a13e884ec12b0eafe08e5b05e126d43cb54335410d05302db5b00219c786bf9d016f8522d262aa189891a3b2fe72ba45f5f9d6be518fe80649ca0afc838d236a1d57e78728a1ccdd2923d6570d24a7c2c3c1b12514eeabc065d7727f5112095190a5f646aa8c261efe40b7be9dd7cdb52b4f4a4c4a8942ac3c3c41acb1a59b99dac5876cece332f1d437f8acc64e5da43e7eb262a38de4784754bc597d73c7ac7f20016b11cbbac96fbb517ec0e51505322cba92a6d75a6d643711f5391a1b59d21865a60685cbba2684bc85bb9e9f3bb8bac4523025ecd63832714ad02fa777e19c81986345d46cdf377782ac2de6aafc4afcf47243c5cee209344104d16e11f332f44f3d70e855c7fb6f6ec37fa028ab573d280220cb9d8b0fb189ea93f54d7580a9dae8151978fab7468b70d7d7afb7214f57c51b3bb3b5b6b4e4e211674fb722e59f80a5ede51bc21ba8b6003384701e08dfeafd5e58a581e096355947f2186343f5089ce6b32bf57b1c24ecc53c5572307186c9ab319fcf870e07b0f5a889472032633f102880188c4e0b132c5c0e309224c2f91a7a63deadc58c0b9b2f5b0509052b217eaf12d19c2c7a704f9cfcb61f50c438abaf9cef0af31a0682a892f8e19f681d84c744f3ce69b3a74cb2f898fff0439f3521961d848d2e0ae7cb34d4ae7aa056d526544363d4ddbda5ed876591d40574ebb53289968f4c0f67abbc1d74f6db5bbe8198a471bd6f8d12dfff35f1a7d3b9b8e429745b02c6a5239018886d4f1482bde297315d08feed39143427ce029c1015cf98dc4f1c5c71e4d5dcf72ea3492aed5353ebeefc9d64c0e25d86b150af39c6b64df0a31f760c10e4792bd1def42ab21fb18c399c1f98ba56b3e8c82ff2b69ecf39eacfb1adc7d4963b5a20b6af2d647f1372828eebf88c223e131247418c4da61c9383382f682ff47c0d6a0a1728cb698ad1d06e299857c290e67f7fc52b819a5e31e5dbb164d76122764585ca25bc9d6ae97771fffb7d09e4751ab64002593cb54e112ee3f7e9bd9079db12aa4f7ed7b9f5c9e93b6a3aff1b6868823f3b4b78798d2cd332f1e953f3355faea65b77e0c9f76d446c5689c7e021042ba93042569ff29fe4fe7c13f0b55136f823ca303f1d51af099bbf860009eccb77a92d774d8c9f0c1f8e56d048b822eea9a0631ca9af9a9dbb794bf2e0bc120a8206a98645637c49f76e8daa05f527f7f26471fe253ed4d8c89b3b375daa479ccc1c91c7de07f1a1ce6f4e1a120f6eb27c78f49773f84bb9d0dbce2019d967f301ae9ae56c2fe43fb88fb99e9d764b534699f94f6e48fcbe4be12e533a311004346dbd23aad1159bafac916c08c735f7598ac7709bdac5f434ad091688b7266fea69aed927f666e76971f1d9b52a74cb3ef4671c680dfaecb00d669cf47b68566d92bf579e8d7f268425e26b6d4e88e687f876b02d42a4c9583eefe80ded7b4719ebcf0ba7224146469abf284d73b66c32ed9c37dfe07ff3a5f06ffcf1894ef0aa671a5c47fd93c2b46aee2124df30a08e35ecfa52faa9f418dbb04c1714cec7f5a8be61e89b8a90fc4a1eb2b94e72597fcd33e50e618772c8f87ef140d613bdeeea5b21a8dcb636fb86cf14bb3f0273e1b50a7907dfb8cc10c0def5e0128e1b2f44b3fcf12264f773ae6049e95df68b762dd5a94b9eed9c25101cafb83625448b4e8db2aacbdce3196e92877e8e03aa948c41e049d70401bcd3ce8729c96f9f7425e0b6ade647d750e184cdd615721e253dd657ffd494b8d5c45098fe82e91f4b2730de5ebd11e3a2f9418b33b4e9a29c94edf416f8d5d762ee625796bfc16f65ad61acd8d8d84f53bf5b8d6adb47b2e2777852379477e7f9cd072edea7a634fa3b565d40e38def2685e18e2e93368331379c9289e6ecc38be213e253629514f05f92de03e12583a44785806e2ae8d286f25fe4bd24e085cab5de13fc31c15416ff575be77197e5f9c8bf4280fee379eec5df46b1e5d77726fc308d67b402a6ad5efcdc0d997a74de8709e2eb3504ac76754387bba9d8986564ee67953936ebcd36147b619047f2375993e1e546551cd6da59d77155d0d01d1c7d319a0fe0ee3391b3ffc6b6a9a9469a1a6d8372c3fcb786529b2533f92caf8d555db4e0d0520e708308d2e239918d2fca6e3cc2b013a46af0d8cee201431f27dda257a379840f5e038e6f9b26ce28ede67a5dc349151b348d837ad1c61a01baefac1c5b36176d0eb55b2c22deea1f8411885aeb036bf95b7ea5bfd91553e9adb4d4de0dc1bfcff342d8c59df2c557cd9966f12c41610f4bdcf63356c8246ad2ec1434ade25eb0e9000f2e9d036a562e3055488dd1d070f3040a13582f5da2502c2fe2d5336a8574e4be224acbf43d7e5d6b810c3119f296226cdfc1e61a870c3cdfadab970334bc6d3c0a080c635baf82ad256810cd98b4ff3cfc62a2d38fbe7e6d38c96025d7d60f7d0de24772889bb184c44ac3ebd95abb918bcc05e1abb6f32878f9e8c7d1c6f180e3f59a330a914a716488aac789ee90a3173717fb8c26e6fec0b50bd8192ff1d4cceabdddc5a934fca08170c7f69505639c380b632c5a215d776e12df7deb4e511fed97b686c4cf19545b507bd2090e8cf745fcb9484650e1ff0afd989360881b89c6ab02bf3c78db9fe64cd9a89f074277e92ecfef5b56c10b2d4a378f7a6744cf6daed3f896a302bd65dbe461847a5b490549d0f4f15368f06133fad954272671516d6a4a6523e1de57dcd4d53fd0561db8f03e9b41275ce8250af92a3fe82a60fd9d8f5844bf54312860461da76c8d6215fb60ad8263ac10f755ad6c8e241b02fbd67aaefce78dc9467b89107e8a7ea9600b738a77996b672a4b3ead8dc191283b9d4c631c371c28489a967dab0dc0e9ffdde310403b97d23e814a06abfb92b45fdb83ad8b904bef48bccb3600f784750b5e415fe0d5e88942e3aed8a54b3dad3f88564806a09730d26297fd054ae6a388b461f7cda2a2fc5da7848dd621fbdade09c97ae5c6f0165d8b95d0c090f5415c9ba83d346578cc9fa7cc644b3cb4caccfadb39885cf8bb8441cd41e286977e438c33dc1f02c0aebb90edef44d049f7488d97c32119dbfccb03c357155632ecc5c310a11dbd750f60a8afe4c8a373c5232ee20971544ceebd0d5b593ab21d0604c8c929412fd5b64085e267476c15a884680131535c3251932d2aa0a4c1b0a55329b3aa879bec1e7311472ac12913d40e444b894ada4b256251be18ac69cd4b532d78713f82518defc216e807861104696f352d8cdd73a3ca50ced68adbf45c7f837aafb5959b0a225acf56eaea090fad47767513ad37c0fc4daadeaf2811b8fd739831c67d3e6585f1c8f0d4f9c54e557a099eb6f98a5af8624555fe419b087d49aeef7670aa76ba5c9565fa2f0b878b9465694368eb55bf0855132ffe8d7fcc04a23bfb7fbf2c477b528d11daa421c3d73053939c4e4da85d886ad68e82b9fb25aae69acaa2a2d7ab2427a6360ad557d63256a2235762f22c402128586fbbe8a9a783b67aad79bda349b0a0058901c942f7daacb8398203d20fcf5aa914f865e768b051d7cd76df6f50fc1cf3b136e9d0387d7b1ab8b0da33e6e984e3898dcbc010606615e8f1d664d0f11a7322d00e9508b71391b789bb8024db0d5802226ec2194094282943a8d5c4c724067cdf23fac3f209e25b3dbfd28f962a76eaf357fff92b4c097358333ce4281f476ad77587a5a99f910702b7d67cadeceb61e355d87fb25f540a043cc2d7844b030a959100df788ebda51867c5455fc5d9bb061ffa7b07dee0e7f2ac2b5ca9c29e645f7266060704ef61765e299b37ea7996a8e0be5702e2f76875f301c09b93b376464b5da46b5b1a3d1f777a687649f7ec7c7fea591c2bfce3b4323b3a3b604bf17ca991a78cdb238dcb43448e2643c3ccd7608b920a77f5db7391beae27dd5c9389f1f6fafc4135389e3eb0973f493d28cb2c7345b95c2d2a58c54e7652c5ab7a8dfddc1afb6efb7cb32ea10a6d2d40098e557ff555beebae6a314463baebfd30d06159107e79c67bf80e90046ddf4c61b853fc06a94312ff8344f9026063c6d1259348da0134c4c187616f7be6193f009ea0f283ee342cecc008d7a4186182dcffe97c0442d95603cca5055e57f90f9eb90e2491eb95f19f2628527de281ffcfff11917ed7130329a9f954b42f97c179354b489709662c0f690baacb8a2c4a2d517f38f86ef3d2fba2f278ca3f523e9d4abb73f672f0c84897436c373d655f870192771cbc18f4209ba6de53ae6f1b167d8d94f1003ba96959fd689b1c1acf1e84d7dce557a13d029379eb19de9a2311701d1ea9ed22147922f4e5e38fabb3455aa16fd1f9f9acd2df02f465e4447cacdb2156c6c678d497e001681dd13836e0d83c6323ed3d5d1c13ce989ab7c32e69dcd694cc44eaee7b3270ebbcbcb01671f9929b8a7034dfadf73c74d258bb1dc606d1196ec569903c9743fcec0cbeca20d93ac03999b7157621f66a1bb47383b53b58e646eaae19d09a8dda0308dbd8dfffde7e84aa78551882154a164def620072dfcd86c4ece791fd4930f08b3ba7224514d499c6b508e971d7bc4dcb6f9abce390caf9b8ef3eab5ab6dc7a803f16f5af484a147824c65998826f271baa507971444860ee3dca4db6df80616bb86572f5ae9e7bec2e840810b5074bb2455ebda435a1ec4ab00faf6b3abdb4efc265e6c09f71f8c13a1a7b31fbedeeb54fc8fb52aca891723612d233163c2b10807be815f98083ad6ebbd41ff60d44fbed385814048a9547defb15bedd7d3ba69fa5f6737ea341b6b32faf23cf4666c4caa78cb314a78eaf4bfcbc08ea8d74fcffc516bfd7fbc211599edc76de8160238bbd814d2f7ac02c2826e8b3d12204227d2c86ca40e68f75aaf3ae166badeb2c6ab9713e9f536c5d04d6077a36ebfc63804ad48fa8fd21febea00eef3dac5ab64bd7db5df76d268e995ecab09f89993a3f357ba019830e5319d8072e3a5b5a97ebcac7101ec1ea761a36c285173b7271fe05f0f21495645f3ec4250d6fc8c8cd30d9a56245f894c4232db32ad1edca7ae87d44da9bd3f12a1a25cb1382f2bc016f1b007f0e5b3ff7db62b7aab9235f743c1a1e7eb60a0e5e3a6a540c1c3839a528279a30d4b4a35b1448a134cfe24d318961491838f06e742d1eacb3e1d2832cb7098d86ad1a96bcffb7e06db9b3683b2eb43bf616ed9ab63d385cc542f86d623b9ce3d0b822109b0bc73c61e2f67bc87b1cc48f73614cfc7574a3e0e4f7df111940bde549a3e755831a6ca061767cf931bdf28ec24ecec22da73604451af729337fefc889ad5f54bf6ea85d5e0cc2bf5ff1ad2c580794231e3fd48d99edb3751e5dd8d5cedb6f201cc260aebdf89f1e4e48feaf94f6b2f2cf4e2cd12dec502d520e14aa59466083b35a9fee4a25d15f0ac19952fee7c974fb15bea6aac38eaf9ce9c1a76cb95763f9d865f48330f9921fa70e1b96c8aa6feb6cc36bbf6654faccc394757e9ed24ddd22821d2bf8963646d528c8d29b40740d0b243bf3c0e0e01089dccbf3bd1249e0c15a60beffb3ed62fd9252481baaae13a0c5f9d5e137e475b1ac2da4ca1deb1078090c33d0d7675e27f2bc49eea01e9cd066c1af3cceda2c490e3288304d7204f78361e991a699fcf7ab7b80350fd54472f94e2fa70034133f300ee723eba7be163150e4223fc403f191c073aaa79d2f0e97a428ac30bff174bfe9d3c748a534f922a6f7606eab7bc3dcb19edc6f38ea55a698671c7085b59eb1fdfbcce630925ba3e22a7fbc95eb4544ee0c1f28ebde3108b30aaf543af7ca0bde27b12eac51b9a20868ff8b85940e3444901ba9cfba8dcaf4426a292f2422b32632e59394a1f280aa80ca0ced6305dd47ba713957c90ec328d8db87c391eaa71803d25eb93464c91ad53dd25482493a3cb698e73ccb07062e541fdc99f459bbb01ab0acba4e492d0e1f7d2445a0f30bfc6a8a3e1d8574dee2a031e125c92066058349e470d6e9fdccde7caae569e95fa83f93982100db419449f3b8b4269ee98bd1af441883bb08449640f89cde6aa775c63f7674d5e826a0e32f529a019cee15387e715dc23a3bb280f3e4f55763b51a219346c3848e983ceee979d20644f7336530f152841ad4e26c8a95c705643480d02a2074b498d65652338f90a26ab20811fba2d056360fb7d43eeba7f88a61a1b53f4341f86ea9df2bbaee4261ad9db3f05aff1ce0c596c66a8739153a4c3affe6b3994ee23529be3a9091ca7c21133efe82ca297496fe91efb592710a09f73c420a01cf3f6f84127cc25e7580fb9d8eabd8d346ac2a1f483e4c9012be7c76ecc0bd5add4ca01e7bbac9384f68899a3246d0362b6d6f28b9a67da6a04e3c1fd93448596fe591f9a8c08ca413a79fc33c830b686bbe467d04af69919bce3f188eb0218caf3e90686e11958d28ecf04a3c5c599421a0dfba06195818af201825bcde768489d4495fddc16f7dadbf96a83145a0abc422a39b11b4d47871554152b454180c0481c58b1f7de2ff4b75e203e0b6dd8e665078549b67a2b779d459bfa7a90b8e02f10fcd03e3f6a80cc01fe07b6253c747542ade306669198507a078d0508f067c58a039dc00f65119575c29e457378317e394f39d802b44682cc024eabad731daad7020f177a156d6615113ee141789f76b4045dfd66fa0f65818137ec1adaf1b4f8e58ccccf9414b60b35e30b09d6d7a425dfc7ed3682d77952076986796e414c0b5ec08552bb6d361727ab958d95e8be49706b9e56e0f22c28b876af5e0e26556dcb2ee4c539d795de9c276e06b03698f51b8c6fd8d2ef887569bfde489d3cbe7256748d542a1e018d8816bc3aed941a2b082ea540cbc3d8f5bdd908f7edf3b6247c9862498b878f286002e729d1be0cf5ba2b1b0cc9aadb8968ab3c3df6e27b1615ae310ee23cdcec3fb369b17e2bfaf3f31a67d1d78acfdcfcb202cc4346185bb1f0dd267599db98b1f952c4b097f1d5568bb3100da46fce853c0a0d5fd3e4c2f2eddc43ba9d39b8a6097fdc031020ecc2963bf0bbb3fb0f89d55b600050e350eccfa4ff327afb37949faeb8268b69f969314f7099fc98421d1fbde40211ffcb76b9c6e79e20df49f2c9df052d1b96a3c4b82918259474333882d6c2ae083edbab1c6f2e69beaf7184a69907f763e6b6d3eef688dc0603ffa425f0f1dcd64bfe368cd38130acab5897666c4b6aae6dc58cb9c4f6a106a102e274234a527dac4e15ea8c457271944d915f8415724cf957f9e6eeb5e85b8afef3fc7301c1ae3dabca2e0dfd9ec6674ca83346dde10d0a3377dc58bc3fc5c36f68d11c6d1ebc24d0bcf448538b1439b99a59cd50f69d40a62abc3c45f096817bd53ab894b709f3c5f39b7a8655ae4cb19e38f5924138ecabaeb8a5c5a402431fa0b5504548a2330d88e64510183b60792610aee47185a9cef66120ae3cb78ce6ad1c2bfa30d95959c247bbea9e3367cc58819bfcca07f1506d5d73c60530723436c11598452f3df06d4c8a1c998d94990758f27bf9081f18d71347755eb0a1cf9c1096c842d5c047333f3e1591fab04dd26ef7f3c1e4ab3d4a373a2ba478ecf5b0b434a85dbe6f7c60b99474c4db5fda39203c9fabbd0eea5f8e99ae137219e33fb04dd0ab9dec02f10e219f192ae9907fa55dc06be86afea6bfc1584c7eb7921aebaf762aa12e6b2adcef90a7bfe3795f0e8bc685798d94c93aa8f29b23718e9e8fedeb3f3dc54cf2563a9be0b62ca9beab095974f1e98dee70de11173380d556cd2a974aae7aecf79a27eb2cd07f5b439025a80b9521a4b9c947d5c1f4ba707f60a5ea06fbf15683965ad5ada6f4e8060ec594567a3aeb482346f64d77603f644ed28c1644a0fb0b8e6d6290721fdb6b4e195cd47b8a2b3b13dab8e7cc754be5690e89851bc31e8a844c14a7d35bedfc4a6bacf58c96e14cf7a378d42962b95ca3ef914af609e4688d64099d08e5399d58d53f65fe912835860a9ffa58e179f5e6a3f5f2c3f0a61150f6acb211699446709c1db29d544fe117c7399aae9937ae66ca8b1a0c97df426c8c834e40c8595f6d86e3d4e887653e338c233c765773a43dfa08e02d55f560920d1040e91447d86ccc362def54e6dba9c8a9096410a29529a9cff529f9ab46406e1755a1d1e70a0c0704d5ef396521c032ce22832df62bf20339fba5981810020a775ea3463e38b73ebcf9e82895e029b46739b0f85fb48724ae9d3163c57bcad040d837ab53abb2567acd8cd9550316a6fdac0cd0b921565c046450f98d4ac38238bf4a98549c466896c0e5835764fb2331f8891f68221bc1000d5f466549b2b289faef19ad9ff855b0a8f6a9d6f7b19771da5d86684e61f02e111a71004c5a8ebb329677f0568e2038512127aad9fed44853f2bc321a809a5f10f9f2c5a4895cbccf14f4d6e777dc6e7b056dd4f6b42c0a78ebe6fbdd378a994eddae2bcf9a14a8367d85aa44c2fd83414c3767cf49058a107931ca2d62f6310fd36df72cc2e19e172bf8382920d88888c20ad1d6c28c1fe694f647eea49d640bed6d68811028c856ea7737a190e7d854dc2c590510f99225fd7896b1dfe15eb2f3ac586df6acf2914bde5467b38850a7fc321b5d102f212fb26ba7c506908652688ec89cd37ca6ea88ef985d570a23efe25059b9a01e559be57cf405d5b085fd593d601fbf4e9a6c971dc315cd29096baabe33ea7d150ad03e37b91aa7987ef7bdff7a92c5ad0a13d15d4719e049046e618f3bdb9a00c9eb92545f799ad0136b45327aaf793570b9924416010124774744ed96da3308d3a3d1ea333a6bf0cbbc9f8b840fbbc6241d59067a572025d60b241ea45f407e4f4074d4a4c2ffcdd6b0675b83a6b5dd484db70f08f8efc111b1c2c7d51c0d548a7c027ff9c9136c0d40f1d635eec4305c0ce3b116ddbe77c162de033361b8da78f47e0dd0865ad27c8eb2bbf7227dca7bf2dbd0340aa9fac7039c4b48c808522ed499a5ca42395b8f96841656c11d84744131414f94f1e1c57bf5b9658285f2e89fca5d7f50ec65b72476ecc2e654adce3f40d62d762404bf4cc5649ec9511f64b9749d1a5d7f8d6456750ad4bcc98280b2fe76a7c8cbd1412b8a3ecb03881acce7add91a9c140079123c133ac4d162b46617bc76f641b4f40b5d6c9b15843dcc35c328fe63a22404262647b746f1dd822d2fbc62bda6f95c2175c7ee480b380e93530088616723ca4cfedc6dcaf3f6693a8118055dc2999238a1291790cb5bc55deb192bd074e615f939058595bc0d051a8131aa0d3710d741084929c76bca6a31be902f96be617824730a1fa42732615eaf4d791d715c8d2102847b6eb137bab64d26294691b4a523df43a47c46f8f3b67494751c77f2eee87b10674d0b4bbc7b9b9e214c44b489adb18967534d941a345727f3b3b01002f61c4491ccc3c88741470727d5ed100418fd6b0c2cb93be620fd5870ddf16be6ec31a88f9c7275b2f4099c9aea6e0387a246af5c02d9ddf45162624b97b56f9f16a65b7b24e3d3afe757527d0c07fa95ab1381e2c4c7638b05f9e8415db9e91d24ed473e132e234f7951bffe39e645ee31515f5f51f42ac8e9a364c3bf11cafa77baa88b1b564ed410432c58c0b4cd70cd56a8cde136c8e3cfc82c64ad5738b50557390041a495cd1b000483a4d63525521a24905cd0306b2020d5e11a2087c2f34691906b5fbba23d94ed77b6a48294ad82f57059f5d853bc5ec62f0537f7bb9053923d19f27d93739d585e78d534d1f8b616ae6404aa97a7e20635fc9449f636be0c6573618c9750d2028a68d8cdeabe21d80af1db842d122246bf2308ca66c15c85cafd1356028f3eb2620c48d95d4f9a5b38f2c98757b951028c4c24710e6511d906fd8868f686b9b1d683ac2950f1d3bc1e2786bf6bf1f4d22b29a703ca4720e9e8ee3b1ac3c3c5609c40ee552d32f2a7897e9d27a5fd051ef6ef280be06ca229084db7e1d31c4d4b6eafaf8a159f2e95fedf33af200aac24348a75178e72745ef907f5f8c7fab9e579ea3fec8a6d6c152ba11fc50d8da8e649f35afafe95be3a429baf0a81ffe454ca1d9d16122d9241fab15ab881fbab41dd59a79b8c819ab41845287b90637208adb02d86fe63fc4844b8b9a104ffef01c4042ff6392ee0481ff685dd429393b4cdaba01b9b8a55149c9cf4d287a15e54dd47900a780bf75e432a4b103d49fd1bbef1b2cd467627bd743f230c28a23d5f087f8abe2782661a51d41d466689cc50cbe164e6ec6fdfacfa30dddd63ba41e9f4c7bf9b17f34920102d1310e640949514553f830bcef47b279d5c9a95945b462692776faffa36e9fa133a1ed3efa8f04daae52bbfa7e9422bb66f121f86e30921b39b64c7c004e76a32be955b769444f2a385decb2205e2798e41d0a2a47bfcd349f77233829a2737393e9b1902084ae31b6ae3a759b4bb7a36654ad3cfc956832ddb8ed94daf051de92a33ca9cf5bfece8fccb446c5879f970c1edba194043f906d772636917506b28fdcb07c98667d07b971d1582dfef818c9769a2f4d25129ce5731371d1f1b1236c0e78b42d354a315278ef4f5ac72225d98713c2721ee30620b6dfca16157785f0d80bb2dd0f1ed1add82b0c05836d068947ccd2d1213fd80888a75c5b21428c8be80938fc3186a5b243995ad32dc6acc33fc7e36490c88b02e859fec13c0667561e322b1b55e93485c2e241f720c7cfd4beb37d1fc186b174071e0721f06658b322e74e88b2910dcfef699601c2700a2b444f5ddea2b8be59569bdfb7d7fc65fba5b5797f0edc940f5067632a5882142c80d764e01196d978681433dd15459a816f60cc2120901298702cde1561488d3c756a3df6eff1f60535910a16dff6f334475c0df1f46d09dbfafe3d8e808a9ffd3a3b88906236af4c7c810930332adf035a09dc59259dc82c3d7e13c9d7bb34387b959e40d32858c79857f4535a201dc5e47a07c69f83933d01884614680804639b09f30c8c4e5d98af5ead711931e67f6a9016c4a3c943df8078aafc8902693829ae87576fe4696292365c406047ac576e52aaa639cfe8938adac3c838a1202675b0a3d6fab3c938151feeec60cfb8e3a6839c9fa0c93ada93b77f6bc370dca41da96f67eb0ca4cc8d63950784f3d3e8200c60d8016b5992cd2a929f476420b7080c1385b2420afa680d91f148bd0fd9a2953ae670509ce9efb31a885b956b4f2d4e532836fe25570c84265af715b9341931c4493fd63cdcf3472f5ce9df709d58e3c0cc4f18cd3ee4443e994e1ac5003d13b0959336704c67eae4219262e077d035d821113f38d3956fb9fcb14ee6c9c83feebea57d09fd362c88f9a0b89fb85ea2747b784d3d536a8c454fcff62e5946a54eb6d419f891159d59325c5c4741c12dd046b39bfb7bc284405d3a1961533eeaf40642bdd1bd3e011649dd655f45b91fd5fc90bbff40681766b2fb274705ed1049c63a65003a87cb59101c3a2280e15fc3e6cbba5118622960e8a8405da1ef9955c67e91d6d1608e4b150b29c14f1aab9b9880719052bdff337514f0ab28ccb85b46fdb6d095e0d763b1ab8e08b18e7688ddca8284419c04cf45e0b9f522decabc0bb764aefd878f73944ec5d2d4e569d4c7cee3243fef317f61c048ed3ff117c22e65a174cb022e5d448968fce9898043c80f634ae49ac6feddbdb98be7723274ebcf799ecdb97172c2c95ab90a8e2e83a002663f3911d504b0bbc1e34cc2e1ee143c7a1835ed1edfad5a7beab1a48947cb6d690c17538f8c7c97d5fb4cb68c2f4b8a96be80dc85b8e01c63408c3be7c4cc9c5cee4461d051fe4adb81789068574c1d038dae702a9a1a45f897d4cb26e71759c80b729ee7ff825bae1b359a23c623d12f2a2f188f47dff537562874d431fd6ad15f30f7a57c767386a31b963b5b15b89fa91c68992f62942d6da41a5fb5777994413a7e26ab283aae58cbbb7aa30e471919590d2d86fb0296c70873e361d8e85fc0f98d63b0a35ebddb514feb60ce39c6703661eac35c8dde670d9bf136a18819cece007fa90df561dd737c389122246d978812757ab618f51aca434b03c6ec68a60487fe484141f0621b616dcf2ec1f803fd65504d85fed65426de23946e2cda76265e449a67264c077342f5e27222ad16a46cbba9f5d9a49bb09fe602e3a565adc117b15d7ab7a9dfc68792056d2f036749e422a106d28fffc2f70731e40aabd19ec9d1d1911a13e46f30e29c3ce291623384c958e0e5fcae773bce67f1ab8b02dfe236bcc9c9690963f9df4fcdb940e7aa79b502b62c194df6b9facaa408acb7f67aaaf488c8ecfbf2a25a0d1e25b8ab59fa11d4dcbb6b8e70f9d2ae7a362101b8e440897d06c2ece069e55dad4d3125761f7ebdf3deea5913fea84ae2b9fd28e27e318992a66f78853261f9744092eb9907bbb0db7435cc7ffcb3baf32c7b57496ea87c78f8c936ccf097fd498fb210005353954daa504a436e32a44e3a673d1339f0e55f67a8d1b6085b20e9fdcf4d7e4d192a344b3aaa051ab983d7dd8ca71ed6e3def1771c508caefbdb8d8ac286e5fde5638b6aa6a40ce51846746e973af759d681c8a32332bff1343915221d7ad36f261a0bc23db8cfc9dbd3a39e1b8810e2c87be603f132a0bc48e54d4cf8a501e29f2c05e5a34917b06893ffb4f0117847a84484e1042824ebf94cfdc1b90cbfe224aba03f7ed6de6334688ff4d53236f783eb9bfda3529d8421fbb554d645faa3483b788b1a2dbb828e3cdda2bdb21e6af68024358e95f8bcbb6f9b61882056402f166e76d8954d07b316258517604c42663a72fb69f8e8b6814eff1cea72b7fe0492be6dee01d2d1e5708bf28927998e956c303a7de54e0e7fdb7c357ea620111abfeb026766a09e7052d0a91a960cd0365acdaf37cd4a13cfe69e3e3ef85d9234b05a15ff20c281cd2f0f1c224627954d1899da3b38ef97fb0223cce298fc5efecec543149d6c856a029ef394a5b1da13b51effde3b45059c1bd2df973ef97853feb847c0782bebafc0552c52fe1af1a121aba1967cec6e70c4e72cb4983f66a91952d93dd45080dfca9b52d143fab373009f8b1603e296f32ba4f30fcb32cc828cfa9d0725d183dc9d3078a8df67095053f54abfbcf2fd7e11991bc8dbfe8af58b041e91c30402828598034054c4ca2c6b358f0efa2b543366dc926081a6d1815e23ba05a1d046feba85930ed19af7b6506e7f095efa4eae71eb2bcfad30601c548520ccd03df4f4ac8534d333afe67cd19e11250e69b879b47036789f0d4338af21fb457a37b6fd7834e9ce9daa406bb56778eb1b37e21879a8540cbb2826d07116fb85545dc735e48e5abf694fcef76c2ad8a971bb16a08a8c35fc0ca1f79ac2380d01edebadd54e122d266ac0bbe711adf31237ce8c802c7ed417d30b6dc7d824ef03f30f1aa16e6aa5a4eb6d1333cc301e2487d3da96d25e77e1b95215e56116e8359e3ffea8861a0351f7d2d5b56590980f7a097fa309b52bd190c202224de02e95a45eae59a4784973f823d9828d3bde177952e86df3e849c6b14ff3ea88ac522552be2cdcb49111c7c69f509b88231b719a9e176fe141f5d188e88c709dc58ed1557c2c2d988b465f59bcfca3145c19d9a05b848820b2864d16423615e5ce3d4ff021046f92adde0c35711b72b11affe88c023f054eb2f78c4460fef88502388bc90b3be8b16b1ef301af0b9b5a34711ca7db43761c71fd555fb1af7dfa9f194bb8fb0db9b768ff9bc0aeedc3dca2ca63e5c7a258d9a9f430951bc4d7d5a7aa71f11811f457643df7c45128b2c9df33e027e7990eeece0761a42fdcd515cb206fe33d45dec75751fd441db725fb78ffdd15ff4e9821ece60870f6c4e6923d953b999d3ac75ef12a219150d1376607fc841e35f6f40a0633d4a1c6e68dd2b51651cc6b52c9ba5ba7502017ca2a0c4edb999554cff46302a60d68b15fef0bc74afe69c62bb063383b4e6caa819b439353d4c4e250cc1c4237e8248221df5ce56d7fef992d3706c76c8757e191631b8ed1f9a7bf420d4411dac09a91208358f2a522f59b2b89cae8b81fb252f7d182e37bf5899a9a1b35","isRememberEnabled":true,"rememberDurationInDays":1,"staticryptSaltUniqueVariableName":"ab7e469948e4989d322e29867cb59cf1"};

            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                if (!isSuccessful) {
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
