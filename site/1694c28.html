<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            * { box-sizing: border-box; }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                max-width: 768px;
                margin: 0 auto;
                padding: 16px;
                font-size: 18px;
                line-height: 1.6;
                height: 100%;
            }

            .staticrypt-content {
                height: 100%;
            }

            .staticrypt-page {
                padding-top: 20%;
            }

            .staticrypt-title {
                font-size: 1.5em;
                font-weight: bold;
                margin: 0 0 0.5em 0;
            }

            .staticrypt-instructions {
                margin-bottom: 1em;
            }

            .staticrypt-hr {
                border: 0;
                border-top: 1px solid black;
                margin: 1em 0;
            }

            .staticrypt-password-container {
                position: relative;
                margin-bottom: 1em;
            }

            .staticrypt-form input[type="password"],
            .staticrypt-form input[type="text"] {
                width: 100%;
                padding: 8px;
                font-size: 18px;
                border: 1px solid black;
                background: inherit;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                width: 20px;
                opacity: 60%;
                padding: 10px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
            }

            .staticrypt-decrypt-button {
                padding: 8px 16px;
                font-size: 18px;
                border: 1px solid black;
                background: white;
                color: black;
                cursor: pointer;
            }

            .staticrypt-decrypt-button:hover {
                background: black;
                color: white;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                animation: spinner-border 0.75s linear infinite;
            }

            @keyframes spinner-border {
                100% { transform: rotate(360deg); }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"2ec7905e5d31dd3b4924adc1a4e1fc4fb9455ee223ec3cee60d358f701cadb4f34ee5ebffe45a65cc2c8d37e9bcf151207c2d17c1cd754d5e588ed9d369b83540572db1e63000c7155de38ee219ad00b3adf7107a828cb3af2e3d7d5fde31f98eaf1834dd0e97441edffa9b7d6fb2a9e8f74732c828879106a3de9455130b6406106394699bdb39a3a35449e1e5e10b888b1818b233a26ed996f907a8759cfa6f05c2e19116caab7e7e32c1a7c7b211c79886073b468cf9e0f772efb286e40c43c8806f30e104520b70fc7484b84cd43186f00624e397c8832c844a30dbb2e92e130f130ef0efebd48e17bc2db4ce35d6eae2076f6d5e5cf93e7d175be4a143b6a3ee1ff16403dafe4094e8f1862655d030508c7a286759ba3cb1ad7ebd4ff0abcc52dd34156e083136b2a667b55c56aa2ae939404de6cd2aa173a8b94d5bb04f9bc27ba04bec922452e27cfd107b0b9842b99d717b5888d7d71d1d07d517ea3cc6e20b21acc0750858bcb8eaf7cfab4b45f17fac2e6a833ce558e107fccff92c50f51e0077ad9514731b92616d2b4edcde4c17baa6d694a32268fd6a90ca76837ff8547a2e02ad1bc1ad148bfb161d9edc5b845f417376779fd9af64e6d3f7fd17e75b032dcd08eb92f576ecb3606b79925e769704d7d8deeb0580ffdf0f77a7b600056960fc2cf6a9b4e1fddf96c3f7d83912897754fe8f274b538385c4c9b2841ed0f838f5e2285d140cb943307d7b4dbc8cb601bdc1b8b1ddc82aa370f169e32aa175ca49baa5e0b01e56eb017e7310fd1b1711b2faf354d7dc31ddf7a5e9bbd855db630dc7c7d2e8f203a1d8f214e170adb60225ebd7cf645b72dfa11757462e5e20a77815f4d5f8faaa5adaa42bb2635aa56a53ded69e6886707ad5d323656f4c8747c04a0184be272d3e58adb361909f8ec8bd5deee3730a3e066d126477205a0652e9ff154fd6deec95dab89fd3d4b87db2abb5a830827911d6fd1350e5df1c788b1bb4f49a8feb2441181d4f2947eccd1f0eff938cce7f6427fba42ef8e821024e5563fc4d350c78cf0516cd9efd45d8550381d8024e7e01badec4f29c7d37884066f87ba8a92de8c11cf1077be8614e38b93a3526010f83a3c9ea2d7a7a3423fcded5754830244d66a2f9c0d4255b1d775644ce5f1a6988527e5a2cdf00d888b6791c342bf3fbdc669c410f5fdb579182fd8a796f62b61c155d655209a1b742d305ca86be6122e7c14788176f4cea3f3ffdab9924239cb88768fcdaf0e270c463f70c6d5bacba2b6ae30c8c598b651b594bdb5b0fa7b1d196dc803e97d0c49369cfe8e1a2ef69512f3a4c624e6c341b86350ec57b127b161a908f7c993089ee40d2e037d4d78e1c01c12e926e10677221403fdcc62b37da57a2419d1e16f8c5bf399a185954f0af54160fa745dc412b0c8602f53baa79dedd81b91cc6301f353f0195c4a6d486ce683051e5a1fa4b5b776ac481df508048bb19a4f98c1d136b395a9735d1560f95dd25aa1204f1ccdb223d366bc3bf1c288a33edb2962142eff755c97227e6aa512d9cdc62e548f705d539daea14076df33836b266bee0fdd33985977720a5a496ed36b05ff2ca81fd6f1d2ac7f47dec583cec69af71e5ebd50215e2bc7d379b4be626f654ff0a02ac8f85470cbd9790a3acf1a399c312ecb6ba41af1150f7b0508b0484a36f8e8f8d1a8a640954638dc28c06bad74346d56029cf1d0a083ff951bcaaaff7d011a7429cf2055f3ab8f497d05096a49aff8b35a8d7528df941c32e498b391729edd32427371a4275bc4d63a9fcc2b46c567c4ddf0f2a0dcb9ea162be5e5bb5c453455a871360a36be9469ce84389caf44cbb9ada2843d98dc15119d47769ed5cc74faaf2850cbcaa82aa6b565ab974c696c6b35aa5e0a63ea1873c88ffa8e60de6b020fcb97a26b56d4bc9788ce9abc60cdfd3f6aa4e3924397a508dc63ebfb099f649c57eb7a377f3197d188cbd8ab440a1ccac8c2653da77ae329053a2963b2323d6c74ffda1ce38a02315fc3fc048d753ef804a90deb1e37890e076de91df36f50bab46432751141c90b67ca6520ffc2a4627ecf540ccea8d1431ebc05a58b28bc1bba1e8cd0b647c1f3d4e51c33e3c6d98b3dc15974fe2f84d1f679a50b8b14b6150b740562f24c7afab38f85628996e12eca55b20691c08de3826f4fa9354a1726cff96ea9835d88bbc78e535575e61cc73be9bbb6b4f846d6ee4d7bf00c70f328aa57ecb4f7c71737a0fba3ca340ef6a146c6342ffcdf0dcb05f2bbda8d87a2da1ef14df40f8932903f7a24176d56732e5b853fd22a9dcd08f97abaf95c5914a567cedd4835e4ced02d67605b31d19bdea727b1dde5d6d4d452251915fe2a4566f7fca42bd379169a9b6bfaa1ad84959abe42a430954a839b6441168157b112705c3523826062e89f7e50de9f966e38a25faf289663fcc6d0a6a62bda00f31b9c1f44031d216f7dd6e0d218c1431d1eedaf1a474cdc2ce3de0dd37c67aa8f39fb0097cb31401bdd439e5096c1cc939f23b8642de86b464ec1b4617532372341561f94a92de01d70cc8e9fd65eab74ecf9cd81530374d0f689c33482d877d217ea9cc2bf5070b5d883e2405f47ee3d21001455286b7093702b0287cbaa251e1a365cd1f5db45f7b8e4c7305b74be244bbfa25097b01f3f6631eb0d7b78b5e8c71008b9759d71404f3f06848b365980578fde64d3096b2ad7605a2dea216bb42fd37910383d8de2dd84665268730299259afafcc7f39d46f05f5f44f6a6f682644bff443050907dbec96f5a14c185c75bc65750b7cb4c82ab792eff2becfb592764b8b46f0fcb4727396bc64546b9dbf72adba0e9072f10013a87c852fa566cdac044f3d0259541720232aea2954aa4c1441428065716111e8c6baaeb32143745a73447f8c9b18f5426921a70d79ca661be87b27fc9e311d5c8407a75291ba25a9ffc27b037a209fdedfcf5214f0e5a80df5e7861098abc92351dff7234cc13c52df992908702e5908f107ff203c1d6e8583727366792632d138fbe2d393886c8b1d1d37e149aaa815c67233ae150469a57ed77c0c85ccbb8589cb07ab07dcb1f2fe7432f9672343c96e84eb89a6d07891b06f8844ffb6d80cbf7686e5fd83e3c781784e4d314370041908b9af6ff4082000272274b30c12c02adbb249968bfa73ed64e58de4f2ac166e7af3e3efd34f8fd9b7f19d579d28978054889e3a6c30d6303d27319a29d890d52122cf9b17ec001e79e8062a1a73032ee92fcbd108bdce604a4df59679fa6eb5b77b2b21c0ac7e15e0745c82de78d4d12c1461179f56631ae475e02b92f8b9d5920b050fd41479e03c15d07396c3f5a19b4878182fcf11eda71f8285dd6bff2e47b62e8b62efefc3fd92455de3948ac2d634cf859c90101d03c379dde56441f33ae082be44e738f0dc2ac3b36082b803cf6b0e1c76c00232900c314861db5857cce0b8dc53dea4918cff441443e9242b64478ea11de240f7f368dcac6f8f2ff47bcdc4f13bc8137bc9703388552e5eeff97a08199b3e93e85209d61665adfcc5714d8c996a2759a8b46efc3dab7729bc683bb29fbb6e98e83db3da1d3618eeeadaff689d040ca2b7cb7448ec0bfd3c7e7331d6b3601ce0fcbcebadfee632405c59768a0c0b2762edbb91f9ba99fe00274005f63f4241dd5c939d47eba5f62b1d14e11a69d94436e0aa492f3b8208ed8b063d5d0a8ae1bb9eefdb15afc24d4ccd047d95f695637d487bef36089e6238000e112910eb1b932e2ba5710ea7eabed90874dcff12670005013db4ab30ec6b83e47c6184e64e5bfb990a248b8c94acf48abfecd31d6e91e5b157bf3737028548184557481d136fe6564e2a10e3844669429f66719b7fd8c53e493fea2205e0262dea6cb33c4629767844df5230921b9c581dc80a5eaefeb5a51597e2af9458a997e0cc61f935dad89e8dba9b49033713d46e1a5c3609d657a7e7da9c147992c3ca08c10a83daf862ddaaf52759d66b13236ce44a8ee0b3924be7a4ddffd56a9853081d02ad68ce2e54d59c004f5e088abd734d367996f8970a67c7fc0419780629e7814a21396a50e9d8145e6559139fb41dfa9e1b7e6eabc41dd240f166ad7894a0851acbf701f3532eb1f52546c27c5b6e877790b14a332f6aa504d5593eb6c0ec37528961b79a4a1914c93e597804c6efef02221cf7739ab94106382407b5510a713861ec41000f6ddee27e12ba59bae6852ccce8164192cd9915fc75938692b9a94f0bfb7a846d89b36dff7393aeaeb3a945588e50b3a9041c461f234c121e407b6a6466d9c220f129dba2e013657dbe7bf6ac7ef2d393a300b8722523b86f5d0d9c9e260bd8a2e45fb1d831d12b64ccd439a673d24429df3461c609f5bcdd0343bdc99112e0279ba3ed41ca7a9fd163d6a1f0868ae667387ea5f09f6fd5e59d70225a71d85764fbcc2770a9e5922a2972d592b47ed201b87a602cfd9188eae31dae672691f3dd6d6a955ef2f98a89a1d57ed3e7b9449c94e5cd4d6544973712aceec32711a849f5b0c9cb4bcedffce58ae8c8f4bbd411ef31384098ac34a9d8faa942a96507eb54cad43768744e9e3530a0ba8e54721fa145d655446c9c2ce41904d31ac6d4400fa72ddb0562cbd6f235f2a1222c0f132acf04c78c859e1e80031be1a44895bc58786c52808ef4cb167cd577e899900ae3a2fadc101ab8d5b3c118be5b1ab222c11e6b12adcfbb4bd9daaf6bb12a52f297ffd0af2800af2641a13d7166a0f357669d7a3382d0e394dac5a016b1c83f24e93ff0ff8ec1577222489f5b1b731bc88e4459ee54c71b3b6ec75bd3a1e6a773b87b51574c0f746338ba0343f775b53280aed69d0166073942c381818d3e5b5473aa63287bf6532f577be76329b92dfdf936ca8ba3df98346f685e3bd6376b9c3430722771137ca2c6242a1d48a5286f0d700954138da9da18393e8a4af0eb47f1a060a5c4300592fc0c2866d45beec96222f271c88c625b0bd7b2bae90de65c02d211fdc74e38be591a3d679b8aa21ff102f6cff1dab867cb698b379e4d606944c74dd25e9ebe7eacd7c1d8622c6f3d1c55b910be5939705f96a71dca8237b9c7205af63833fd4eec6c89f9ecd06e1952fa4f7043f1c31dff2563c44b0d91c5f89a88153be4552149355d1a31cd7993e20c6fa2b6dd4a77b6e8065d8ca4224b8a805eaf064bd11b2b158f655d22443980416bc852cba8fdbb8ecd90b080a8aa0b99cb3c1b83cea44196059b9dc0e5ffec401e68bf0cb78c3d942c6899dae2d63f0579f6fb22876b0692eda152eff320e628323b4fa77b3f5496913e4efce8c9087c4753eba6484cc71a1e6a8d85b42a6d9d8b393f60def949d9717b53707feb9b54951a2b6617ce653eeee2893ab464d70a196168ae809e2eca37ba86316de776dc7f3f0c4dface654d1ed7f9b782769f2c1d3409c86bdad746a979c9d9dc597db03b8faab23f67dd8b25e90ac14527cc35db2e011a3508947341491b15c7e4762b4578c3dca39ac2fa1165307d70fd5186d2b1424bb4050674291d1ce6654163cb62297634c8b449d85842f262d5f7d2a69a52b5d1d6f4a34503b287fc0eecca769377db3ee019e894d6525f85643ff87059f737cb91051f9576375e737a2b11eb2897e76f24f081c4b9b73263830ad57a0e1caa4c81cb52edcbbb8ff2d4fc5e7982cfba3a99498e698586501c1440d0c457bd31379a42de8f34d7b0f8b1ca72b733012e44f3b9df4edd16d7e5bfbee2609d8164b5eb4986a361bdbc1029287905f7921f82045936bcf604b77f2c258da9fea5cf16569b968f917b5dc1ff45d38b87f152445651647209b1fa84ea72116dedf6202f2b9f004e7298f93f0418d463cb288b9cd0fc377386f5a6dce0d5be22fc39633663a183ec53ba189ced57011b477cbb67293f0772d1895966d165fe8094aaec0b404181b0687461ae8ae80b0338241971e6875139aa77e0357493d62228fb1aa7e1d27848dbed8b97293de0d89d2a8e398347dac8c6f37622abb8f6f8c9d4aa299a1083d33ab83bfcfb40676da0f7ca2d3069914df5716e3865b12956be5da245895fd4e35ed236e2117138d2d4b957e997cc8478298aa50abe538a66f1e3e0d28e9e07d93acdc25984349ab279987e0d490fa98220bc78b8133de7bddfdc42df6e52c9a0f76ef83f2a2359aa1dfab7b7428faa7ae739acb0b6238c1f14fe7cbaa39a75b1d40ebf3259859ac6d6278fa3c7ef9ac70f5203e81072db1012c906fdf6f82244d7132441af0f9e2ce3480d970741e7ce9efeac635eecc9e020ba6a0dd0f39fdf4c195c052c571c584e7f97c52c8f50b063954049f7605b2c4649370a0d4548a559127c21f3662c33035334185a70048dcc1d4d6b5e04488d9f8d741c8e9dace537257bc763a50b100fd4ebbffaa5cb8adf82fdce3de1dba729659059d24aa58ea9f780454ac14f06f14c8537077c37318f97e65227b5c49050142d783328c3617eb217d7bdfcb1f93ddb451eabfffe2730e46222135eb51a3dd57b46544afcd29fec56ce1780cde359427b872b6c773a47d27565a855c969b9187175f50aae75376b01c09e18547afbf5cd76c32d5a6caaa26c6aedf73e43a5e6c620fc1b66a8e81ab3207cffecee409410d8b131fc83229b44791bf21ed1d44541872cd3873521b0232c7732b5d374d573889c8672d8c8cdcc4bcdeecdebf569c644a4567b201630387a24ec45b105ed8240880f3b14929cb6c81b5f7eafc6dd6d46725b94519f465dc4f25f68a415aff042726bb1c5d7e292c4411773985f2f88e7fbeb3f984454715a16293b3128f17fc09aee1059ecad6edf302f2359ab7f75ce0ffc97623f6d7681d8b180502e0a685643c2448b9025c54e96845819d5b492a987b265d5bf257b17b20f29250976a7530ad1823a1fe28263acf169af342342eea695d46ae7f1250d6d2c85f0a4a961a54d3349d880729879f3c8c5c1dde83be7c8a5bb0a8327f1289c832e927bc1ebd8bae04c7a2f1acbb0b12983ef099f7631ef82f8f652879557d102ec2d562d9017c88e05397f5a33225785df08197507ac21e9880bcf42e13f21805c307ca898367229e007c77eaab90fe7e3c50e1c016a74dc50ec1fafe67fa1897a228953d6419599317f18143e0617c949249ee63afd376a34e455c2a330d090ae7b07a7da5cfea5f49748ec9a04190d453aba0d71d45669807dfb9e878b70778f0a6fa241f4a58c59fe6c9df19843b656588839ca2c0ea4e5bc95b652872d406bce216a51dee054054a409cd89a03ff9fbdbb08e67711bdbe39cb8d561ec2a092bd2910b8c73ef595ff361e858d776a9513eb67f2e8887770d8ab1c491eb6ce128f7e84f4e3cad93e29de765ec35b102ab23702b0c8c2ac34f1994231c968c1ee0835867eb8bba13648086c2cb8f030362d5c4e13330f3491e5feb62960d46cfba9d8cf1d7fa919a809fbce6607bc8e446640f170c7458bac512c929cd67a3cab120ba74c9ded9b9880fd21d8cda456ed9a6f9c370a1440c139e5e09347ee1a3b0b34947fdfbd53738995bf9d2ffc7b5e3c520a292cc62040ca5cd9a41f4de2022b8dfc08d1e3d6a33f7067389496366fc9e7f8f24b902fcf28b22ff13a7ed962bacfe319a4ce12403df309523d8ba3916c075a885c3d9313a856eda0ea8d8c1debf19db1961876af05c8a3590e721b383cd8447c5970d120b4322bde9aacf8881f5fb6d3334fe43c74cc139cba1210783ad508999906409f150eb6f3692d0280a8d94db9da43a8897e0ddff7a6bcb8de04884cc833ca1392b3afb23c97f9bfbf2b81d70a7cec2ed6362dd8ea67990488eab031cdaa677e460703d4fbfa7e71e13882c3a1de1b14837c97d27bef1b66dda094b209a91dee1fc3731d67896835f95ec5b4a8274a64e738b61bc3b4fce865984af9d6d52049292053d468ee46df6106b68a0495163a03c2a12b83718bbc126f1241e2b8bf7778088b9841d5ebd0046cb227f85553fa03458e23e89bcdbee5861b687a25133ce5d32046ab1f8b24e5ca61cf9d21c781deeb6fed45ac73e3fea3088a985456559af783b8207f699a36ce73660ac36b2a0c62751a27e01f37e420c0f29c3dc92bcf8a76b8456af6ed3f57a8fe6e3a3fda3cfc748eb4f34e60497945241ad9167fa70f6b8b66eb8a3a86145a122ec8a5ab411827fc3bd35fa3cab6c11a3ae34ed87af38541263ca10e0bc7e507eb6b437c326853d52ee85c2a0be8f3dbd4a27581914ec6e5f19d70eaf135dab5ac6767b0158ee853d8a641427e9eb3b68d6d8ebd45d7656e1a9aa4d13aeaa5102d2d3e670f937b01c797e2c646c69eea3ca8da7b76ea43698303b2a582509da72849fa67dfdb344b0ef8c672b2e4302809b76f41305cae0ec1fe729ea65ed36e250eec6b29f601f537d81f1ca4c3b8439b613340464b0b4dd4e7b9c7835e4aa6b031fc80ace9cdaeace1f7dc34e84344f3c8f52b1aaf4f30a1ca353c0dc4c426be7a3833b7dba0e3192d48a72a0d5b5308c25ea595cf25383734d487e032187179e29f3a3c96fc22e38a2b7dd7de584427f676bd294c58399a410556b03ed9c82bce9904f5f7bf22da1fae7b2f1d312dd139a78d080902e4ea59cfb4b0fd4028294dff1f196fd65e46c15ce8dc275d75e1040b8de42982707469ce8265332f128f87a0b8c2ed3a36e1561045ed5a4550480b4adead3c71a830ac80341ef2489c93285521208d8395b6002290952157c9ef3caae3684e8187019a4d318983b594c0665ff5bbd599fe64c8cd4cdac85b9427bb1d51fd7032f1d80b3e5b20cd48e4bbddbdde37fb3c557626c76e18486e60348a579b11fb4f82b3a101e8448691c1a44ad10ba352ff3a68c1ed96aa3c8101aeb3697f8d0e5c54a5cccc8c81538288601e385577c4394b7339d7a9a67044e8751f1e44ecf830dfc97347690df9fe8ced649bbfc13b311bc231df13deee1bb3736850517039d5baaaeae7f8dbc30d69c1db8b12ca21b3a40728cad788425f2c44f795aa9d0fd1cb2c29a9683a2e4e50dd1688580d10ccce3f148660042b4478cae4b452d0f80f00cf14287b66cb15923f1671c464360d2278514c33cf250a95edcf2ce859a672c3a1fdfd87f1be99831bea9653c144e34aaf18661356b38080a72ccd2349a4fc8841256096e0054de718f1aab972798d29cc54ec583992db22f277498671c5d5e8d722bb7c1abb105deb9c49aa4424503ffa6ce5db2daa8d59977bfa85b68b4bb410c72105d8ba46da4042ca61dcfb4c9045c9d618bc76d247a87af3f7467b2611cb5c8e73cd092a21f93caf03e88a0e599a5286fce531cb950351e33ff197f3a9347b7c8d99756522887651e63e38711ef7c48d7c4762644e6c4a60c5bf30bdc2b29ade16937976df0a0739de569928a343dc5d947d3ba9042e6eab02942bedff4f2704f92dc80a35d82eeb5b53c76c22bf598d76a84a8d0d9a9a42438064fa92b6723c28ffc77e201fe87aa7083265f41d35bb5badcb51bf787d5a05d60829779dc8bc6a9af665d786764fd25c2382581325b2bf97a5563f6c2474bd6de321e6d931b0ee7c907befb400fdc0c383a7770fa25daee2ae5c58565968136c580f05ece2a8eef2aee342fb95ce5dbade267ee44979f246617090a0ab95997eaa3fa8ff16da2b754cd861230bca0cf8018bcd0129bd8850dca07acb0beff4210d50c39e43ca38aef8bd52862ddf73f440bdaf62156786dd217aeb7b5f221c39b21cc87e3de7aa1c8a7223f2ea5fef3f5da8f3d7df9b1e1d6dd29846505ca40e59d3612489aebe17ab614a08d14bde605b02bcc11caf792d172ed2477d60b11a4b7dd2200895bd8365064df36c6b9b386b50657f5d34de5d805a7ff177c71b61b0b015f46136856a7b846e8a50591894365a927dec3813a85798a3672e5ebf021268041bfcdfe3d17f483ef8441721ccd2e0946854e4148828d2a13c69bb8abe3b703d363232cb4fcf28c285a9fefe50f2596ae60083bc69255baf2c4052d334b53e8b6011c32aba70bcaa4733b5ab8d01fe09ef7ec1e0868e13d3b56793b81560733be4f6a4e1d835535eb5c4bc547f0a73b5f0adbf2d57d97553a799395c0d6aa047fb1c8038340339483db91dc38683bd5884ffcf93d3d9dfdfb2ab6db418c73a13e4089a2f8f71e411c7c1f680c613a44518d2b41453f04c2cfa4f260cb51dba23ec245687860a426e361d39f75c5424803be5ae9174e671c1aa751bd07aadf84edd8b90350ced6da98fc9d68076cdb79e435c0eba6f983d19c76345ff0e4e3e9c071c6461e7ff659c585d2ad6e5bc4235ad09cefa4817c36a737d13717adf730cb443ef79c8f1eaef2d7e2a9f1ff5a5391c1e757910d2277aed5d268907084aaacd70547792df0f676496e5f419c05a3808088049a7e42b503e80d8f4d20d269128136a3c1ba7e70739c6e3267a8486a118ce5ac6d4453e8407bce4a46b2cbeb33807530bb19f8d96f621357fb850182f5313da223a596f4eb78edb93133b45fc29677a39e49e1e18ebe1932840c99621e9635aee8d225abc35c4e22b8d3ba50e5b85b0f64a194e4e1eea1c1edeb4ecafa2b104fd645e77630fdf2bac0ae87cd28b5dda4e65d88a638dd9ac989648ad413de1945224f35ab8eb245d3bfe8bdefca2694a302eba64008a81fe2e8d6e37091e886e889526c68454f0dc3c2a4b642925711f8d0a5b8f0ff35699b09f7c8cb5a4478a3da8fe5238b505a747c8a451f7acd0fc3d66fd81ed086708f30e08a2f579d3fea1fd5c923cce34efa9ac7c8de06b99d0e721f0286185f57052cf2a61bdf036ee659f4e3bd69185235788b0a7da6cc8ac44eebe7a708ed934d2245f9534eb93e04fbe6de2b2059c4c7ba0e9f94f0efb976bacf239c9edb8102240e92cc96e880bd64f954ae0b89dd6eca1affd708627e6015737a34025041bda35d038b8761be23e635f832ff15a8a4723bce29a488ffe5882ef931282bd8a42f3beae03d1ae83322e1f0a3259aa7a751345e7b3d29645dd91863fb8d16d5771b316b61181a001c9cbfa96d6898cc8e9fdcb79ad80de090f4cc9b759a07b907ee42666d25dc74681042d12658d28eb6c7a069166b4b59debb2b5c9abb03a749bb9cfdc69ee407824715ce658337a4052e604ff1d6c950c529ef9d9bc97f0cb152289e14233758450b42908d5c1d9d9823918b9d4a44eee342109da95898b3e00006f9661fb19146e3dd2ce6757af54ca72fded4ba0d824c5eeb585e10ada0c2dac80faa65c9b6a9dec05791831dafc1ca78fd74dec867daeb70b13831f22fc71777628e57305e1f6c1fe14f148429707f33ee378bbb4de9d2e23150315dc4859032170faa637ca2b4629e867b8b98d0c1f35189949f92ed7512510c908e3ff2d2213d8168cc4ea564f34b0839042801558ac0a34047d8fa59f8ff41587042b6bedb5f8a5070334f6b2b1e5c3834194547ba6e86c373988bee2efeb025398d94457b543d3de4ee974702d81c6550f0f95c5f2c617e56cda3e6d6f0ffa280bf7cb9858279085b77b6711609c527fd7edc3ac854e682a895a7a42f5c4d1ed20b0db0237288c31bbf3fd4ec66e631a96f2ada8ac900c5f2b0c4a2853b1aa6a092eaa2c84d10daec50554f15baede7bb692037e7c6655d30e801380591b5ef8bcb13c071000692090c184cb98d842fe1b37092eec5fb4f22d5658a39c7331ce18bfd82647c280a79cc33e7634f6ca1b61eedd8837b3451d179ef26f5c77bfa9e5d0473fef6603e04098086592490258e162a3a7fa13250906be6c1db4322c2bb6d7f83e666f19f5a19353bcb36587cb552065faff7f9f572452616f4bdb8399d4e6a39163d48a28ceaf69100797a720c4c512ed4d740cac49d1008b143645cc0097ffae09f9c557e79277d3d3581a449d9b211b0fd1385eea687eb75555bf0bc57a2d738b7101c100bbe0192bf1c7f9d9d83408e6576a8669b4c217a0917b48d5328f99e0acef9d54adf9b573a762b95afb0a9d4daf2a0a7c804b2fbd7e2038a288972468ed80548365446a8f8bfaecde6d28d02ac1efd5f8a56ee560abc10257781c280420cf979c527860c394295f515949b159dc56c02415b99c38beb37d8beb3aeed940f3af639e13f788f8a6e64c6b5efa08a238ae8dfa0ea1a40efc436ab9ae256df88f6f4d3ca0af65c180605ea9fc3c46e3d01d3bf81048fc964eb79d62d125a6b5991af327373571174105a390f8cdd56512c871c36a40649aeffe980f6b15f2cd10458edd94da795f3ce030ea320032c7acdbd5438981b7972d391fefde5d69537a1e954f3a7d8b66cb58e1a691c5814ea9a0f682e720fb2a4ae344925ad8242649d3fdb53d084b1d0d30111d9c97cd55a411750f3fd2710a421de851f399b7a062ec2757577a464ff82879dd1a9969c1ad8ba97805f7544700b3e276b2fb43fd96f3beb686b454ddf0418e3ff79e102479d9c7c5afe1b8e4197fdebcee1e018f61cc5cd2d2d797f15b9941aed595612504a3de7ca8b49ad75e486c44d5ff1cc24706ba2538facec1568f0cfe4a6f2d792ed67b1a04b0734fa18c51641a9256f6f27645574e2db484597d5c4070236ce74c10fa395558d1058b99363898f930d36c379aaa3106ef36adb3a1d24ebaf1a427b9c87438d32bbd59555371e0892a6e57ad85077fd8b3ed71ec55e2952d96a05a6a66851ef2943d2e6d6148b1100cfe036a6ad8d46234fe67da88f7755c2dc632835cc9e9793cd44b26087c04072a6d8963d3e25eb4cb6de7b29dc93e89efbfdbbc3dd4fb4a3bb059462dae7e08e88851c9e5e2ca49b72271f3a7745aa9e11436a42a164c44aa73445613b87ff79ba14d544ff4b99b6a776ce13a0149b05cde67c23be0284fd9ebba4a270b9a0fa17b1d301c2f16162f48a9e356ace9aee337f54c3d6ae5b9528ac1f16e6d052a9269aa27f907ad580bc715b6032fc775d8d7df824958900288c94acd00b3e3b295a819135dfbce45ac7f21e5b8c7ea19b7515d8dbc0dde9c9b811aa437bd75e3e52ecbb7d6df8f02a7f2deda4848565c77f87c15ec38a7d709cad290485330273e228a4ccbdb13354bb43ffebfba66d6c1510308083faed2ec13e02aab454b441ca8c995e79be70d225db846623d1445c914a04ee25210022cf707456467a0b1264981981aca19ab81ee4a832994fb3e60a12eaf8ad3320253f0a502fee5ff3ca73dbb5464430579670ac882bfbbb55fe2af51ea7d051b5ef7eaa41e94c0e40c7f7196a02ec1a6716537cb980bb0a7396393f593d366125ca32810b0a31e88a77365e5dca8d6c020b2d516b8ab5b34a72f552f0aea10ace6484b101f28852a10b64735b7d72086641026c457e466b802780cb4e5b2364383bed21e68fe9fb0aee7ff660a926d777ff34fcd86bef6fd2e2e5c3cc80e00b0d1945d07ab421a14b0c922e138013dbe3a220c848c7130d1e7e37a49250dec12a633738116c927e5defdaf41f710bece6d33e15828fb7a4cfd62b3d7751dd1f2643953553fc6fc4bcfff12706d2e6306292e778bdc0d093d44b5505fb582694ba0fd3f929b6686982722fbec5b5b6d1d2ece2df5d707abc3c894e2d5a2fb98802ead6b84a028be89ae4101d3336b1649e4c5f14441be15de112a0baac85fe0e9214df969460cefdf6c7dfbd5bedb66557ff9ce0e091b06c30e77289ea9a8e49107116957685e9ac02581182623a37bc5a4ed3321711368cab031c78ed327715c6ea250270f9a33c783c6bf3849daad9187bfc2fad0afb58cdd1ba14a4ed0b03c5f5b8452c510039f696bceca51778431a29a3a1bf8fbbc893d9f09d73324873bfb4620afb6e02645f13e0040fe085f57e0beb6d89fd8a77c24972a1bd0d6ae465cdd7d28d58c74c42fd18c4245c5e40b3c478cb612404bbbbf50be996ec8f9ab40993ce39cb59a06401b414843003f337e97db599348bb304ae4bdf865711a626af3c54fc3f6529b4e94bf9d52b5e3d7219ccb8241ac52c1343347d94395ec119ef826f54da5441e082717c206a7f850dfb11378dc11352396801800968c7a59e87999f9d54310901cc3589f82fbd689a54b3aafde9f6bf9398fa0516bf1f530161a2485c9f7a6c5caf2dc31a1749383082453276010280edee70ed78f698f449f600a78afcbf84968965d5976de822ed042e074052cdeb2166afd2988424f180fb03f4044dd530d68284a518009e7d3e3a279cfd3c3c91e675c120631dd98ee58bcf51a577d478fb51954148442d0806b9cfb7dcb9bbbd63f4a8f6aabb8b043bd208837231a874c82e54ddf60c97c6a03e5bd2d1669a0b160e2cf4c3f43b621db9aa8dbb46090f45069bb94ce14d5846f83c10b9a947709068c9c93bf4ebda375a45fc460df6ff06fc1f0508b4e797601c1d3dae190d50a680163a06e0ae7d8f717fd578d2a325d9ace1e7f6a0f2776c3f38a6dd8c17f6386f3aa022ba2c6589813fafa0f576c2c489dc49eea5179fa01d269ee883894bb013006b67bfe051a62d2ee1a7121b87bdefcad430ee6673291899f14cd2cc0fce45211ada78354d6255eae85ab147950327f32c6681b3501fc37c3a617a224d2585499d2595834000db7ca2c1f94701b0eff57bbdac180ff9654b51ffc210873b8c79e0c62ff3be135f469eaf92f537f73def1e3551cae0761b05c89354f3aae1d6e3d0185e4dc27276f1212e61879c884d899a4c2bd91649ecc8962dccf4190cd533010677c0aff2571535293d56d4da6f4b6ae898a9ab7981f0c5e12aafb17cbe2e116ba8b287d8b9ccbb4a658991b57f07002856940cd9c2d001d1fda87c919bba1f1c8f0e3355ad89f59773fe4b9078c67e4a593d64e12f999293df3c3c1dc4b293ea4939bcd63a737292d95531450a204d21b3ba00265f45375fade9c3af13e1594f9b68dd2b64b8fa6a5a10dc285eb393c79cd8a866d2bbff1e414ee95dc6f01d130e55220eafa918f701b3b71f0ff5c5c305dd06feb63c9640c25ea489d82dd57269dfb7444007f829c97a566ccfd42e5b2e6132cf7d3656bfa2d8b97ed2f9286e2a26e86785e427d25391827fc42b9b9629738a64525ddbee3d1834ee0b96c940a4608496173f558bbf4111af17b2708cb1741abfaa5864d72a214a18c5fe915294a3352080a1a72e734b306c1e8cf4c1b898cb1815a175ed81a44b132916de5aaf7bab6bffaa34e7fdbbcc08c43d5c3cbcf6de97b9c35a339e6c81d86039f7c4304147189bcbca8a7439afce781e043f7e91af348bea9ddb245a5547b57f77e911cc579bed95e70f2fe977e7bfea5a48ddc331b5c856185b20bd483095e483c03ab93b79a20ad610c51197ac3229429c59e500d71a33151646c0de63d4c702a61402d742e3e193209922c3252b845185e85381ba20e6755d4b176af71642068b37bb18bda4afa7b5d20cc839e08418d9ee73cae7d96f1de477b25b6d0043dcbed4f50f833b81e2d28e0a79ffc0deee84a2ac961c2b46bbe777e63de2e76dbc456462dffc1eb6bf87e3aee37216d098b4c8a0063de3c47551d327f4a4ff270b17e6b45071cc865ec7fc4209a3351bc9a56f9e2047351b52f551090fd4c3a874ea3bfbbaad5b09f6bf977f977659fa6657329448d8c3850742208e9cd6ab5bf107f6110c060f4d9fc0fe6f564398b21883b2cb2a9767f43e65ca189f36016c2f0481ad66529b67e3fa5b3414228fde421795dc8426daddb8626f64001a5001290584ffb5ec217789c182af4dbc96d0bdd97e549b3df861a8b70aa7ef05580d8496f440ddb80130e43fbc11f2dfde021d36c3b7af8dda9aeab8e9ffdbcf2cb36d920770b4ac2677dad21930cd06c7bde8ef7c2c98d22d1d36088d4fe63f4c5fc8478bc63082777df08fd5d922cf4296a665ab35ad98720f84b40060e8e4ae68ed30e71b7b5cff3134342f040050cd1066bc60691f7f249714a7c4f611fb8eaa0e75d6a67a22c48ad8282a6a99429f57bb305ea6b83f24c88517f28e877d6e774cdedb45f38c7baf6a534a620e5318c3cf5ae27fb23de8644bb75dbc575f30d992a038a88d02165f372c0be86afe38d63b93e81cf54def3eb02e14abc784551373652706c8a9ab3e0f4cf58080ac1f88361730747ad3c315eec9af9f59f6d4997e6ece9cd50521f23ac8c44cc901a1018a6d6b4d97a6f4ca63dca16f3396bcc6c66a01e8b41c57f8d79bdfd49ade97c22ad877772df3ac8aba5172196b7eff8810ab03b424558d5a6737e3ae98034dfa48239f091c667d808dbe4123168991ba3d8ecec495baf7fe3db047eb5b806912f30727b4180cf5d9e6dadfa00f003007168d1eca7653436363bcf872a1d788bcdd75859581b05439244474df6e5215ebf1a3eff7aa5bd2efa074a08eefb62c4513a57f1f7852c791a08f23dfec30ef694cdc2debb74dde4959cd694e2147419d59c17c557880ddbf49c717f0eb2b7b068833551ee735244cb32c903e5fb3cc12ecfd365de04e2c6fdb38cfc0dfcd1c486d5a6a1cb7e6aef412d62cbcf84ca6dfb4c9608af226c599c6ddbcc2f40fc54142ab7759bca07941211803b3569b854872d576884c60b60bd5271d34ae82dca1e23d8c08085eb10bfd044445e06fc68b3b6dc546a2df669ba479f02fafbd84e86930b425555358aec7873ce076bc07d6a6af5e800fa1d93b5148e4f0e26f7f666e892042f2dc03fd9ca7430bc5f7c0ab3c7425ca222b4c12f8f340d0e14127e5439361405404d632b48ee41c8f38791e02b280dffc0d2d5a0b55692b31e8d2c6ce13c76b2e01cd7c6a4ed728419cf3a66f77e89a2d4b1b99d2c72721b12cf134bc6751326036d8913a6a430c90e4b9ca004a27c7b1c3581446de574e53abc17998ced3a83d05c10355eeb3888d87a1ee645588c1863c6968844bfe78ce9cdfae130d8142d0f86b394d74a5ba82c552ab5f3a471b6637c33ef135e6c00725c612c938d975d5d7b3c26695764a7b82ec5e919176ccdfc65171bbf23de190fd2013e303ab457a017128fbe5f500d8490beaf7ddcf9b706972fd778cf6fbf820fc8a708c97c4c8154235118f57aa0159fea89bb193a2eb8d686b6f0466862f87ac3ba384569c9c946ba575e53fb3d39f86fc8273a32e8469b333ff7c35b7e57762b27b9d7783be3a507fb36ed342968ae223b89622b898373a78517618dcc954e899cdbb9c1535f1348614779fb1a1a2eb2945a25849a359d0fc0dbfc68b265cfe4fc87975b6f4ff0a8249bd9e02d8f1a9d657fed9015d68f63dae581f8f59422315be261f6f91c818f74c97b2606b60e816919836dac433b80b9dfeb04bce5e9b7ca1b84323d6d2f9d1780cb532c078721ff8bc4b58799683f3f2bad70c0f0eea6e0929512e280437f75aaa70887c73c840927f3f36f988bf31a0cf110b0be605383914f7664eb1a685fc9b11648f6f3bca27cf82282e57c22360e197a1922c416a55f4d2a697e345623de3c121457b739a9507f09fce5f6f61e23e51375372ca04b3a4ba8d2e74628b5ab1d3774a0cb60f80d39fc0ad204aa66131ac7b1f02c28425fbbf3a04dcf337e76832223d457c61c86ff17ce8c9e0b736fe85ed790379c79e0f67325fd8e8d57c09252a23af90","isRememberEnabled":true,"rememberDurationInDays":1,"staticryptSaltUniqueVariableName":"ab7e469948e4989d322e29867cb59cf1"};

            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                if (!isSuccessful) {
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
