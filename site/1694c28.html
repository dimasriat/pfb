<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            * { box-sizing: border-box; }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                max-width: 768px;
                margin: 0 auto;
                padding: 16px;
                font-size: 18px;
                line-height: 1.6;
                height: 100%;
            }

            .staticrypt-content {
                height: 100%;
            }

            .staticrypt-page {
                padding-top: 20%;
            }

            .staticrypt-title {
                font-size: 1.5em;
                font-weight: bold;
                margin: 0 0 0.5em 0;
            }

            .staticrypt-instructions {
                margin-bottom: 1em;
            }

            .staticrypt-hr {
                border: 0;
                border-top: 1px solid black;
                margin: 1em 0;
            }

            .staticrypt-password-container {
                position: relative;
                margin-bottom: 1em;
            }

            .staticrypt-form input[type="password"],
            .staticrypt-form input[type="text"] {
                width: 100%;
                padding: 8px;
                font-size: 18px;
                border: 1px solid black;
                background: inherit;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                width: 20px;
                opacity: 60%;
                padding: 10px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
            }

            .staticrypt-decrypt-button {
                padding: 8px 16px;
                font-size: 18px;
                border: 1px solid black;
                background: white;
                color: black;
                cursor: pointer;
            }

            .staticrypt-decrypt-button:hover {
                background: black;
                color: white;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                animation: spinner-border 0.75s linear infinite;
            }

            @keyframes spinner-border {
                100% { transform: rotate(360deg); }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"550fa3f38ecdf9eb63ce7bef6734b1498a404360c3d835b06af7d29af0812aace72bc5aed4dc4dcedf3257e457d2b9ed8ac0963b1839a3fd2606455c4a54427db55fe41363916c6b9632117b40c48e5afe9527c1101580d66e892b1e763b0ac302f812ea90103f597c01a5ca26ba19973bcd109e25079030ee5de3af0599a24f264c539042d52a8e7584074afecce6c76b0f6197867405472bc9f8ed70dbfef700c0f0b4ee4d3024cbebae64029a1e452ce960e3429b59c0d1fcab22fc52ae729e5071325f34c5c82575a1543254970275d075a78b0e2f7569ad356e456f924147c880c687dc137e42a28e9d79eb7c85d21cafac1d30a2c7ea0cdbc364957932fec88845442899175717ef55d86af1b920043aa9d6bd636c2e60e606f0d584debfb21b05b92e419e196aed9ae990b269bbff2c22755e1daad6501f11e830641e32eca383eda4160d0cb58feb989f90429e1c1463dd94852450be29f6a48ca2eda14858d95d34de49ca465f0fc49c049df2f8eb543d0f07b3148f7e871a7dc70d25ff37bbad5bebdb3cc447e36aa9698bcd7d6ae369cbc8000e7b0142325f574e67430d25e2ac15337ac7adb2f8c587c668929cb44cdcb52fc44b1ba5ace669ebd7be7d1fba362b8a3897f1d6ba2b711c10cf118ff48e9ba271b410c205f3aa5fc8edd0828ea6bb483a1a0a9d4c835b91da39913da3aba88a1268f1f4c5b7160e4ac69b6fb2446edc1b1c9d1819652eec48e0d77d66567835b565bf63bb3677efa7b62b695fc55a7dfa4f7edce5f88f3ba766d2b59fd98b3e756da1f224f1132a09bfd20e1af7e196b9e652c412b0ce1b4c266d65089d5e92f2166335a38a77917498f36aa538487c8cb42440a655e8089174b3da259ba3c5cd63a8484e9d4e79fe7186c946f9e555a28eecac588457c85b048e8a66ea1fec071e6922812e02364405371a787a8be4690addfcbe8a661f0fcf150d3fb429613f5574a6b92d914d8347bfa7b96ac2d12472458ddeb51f7e3b9a6f34fbc5888c97917ec4af5a943bc292058dd02bc3ea71e2219b8a2805eb5aac3e99f3927f6e6e8621a6f78c5f08051cd89a86f73a6ca0e2233bbe4be18d80a17eb2e110f8b1cf28ca59668ba0cb2396f743975b52e4d611ca839c9ae07200e115810252385e086130f7d4b2413938ac240f14a6c03079c997c70cce3d9aff5f691a4425feb998aa58df536088ced89459b4d33a45cfef7a6932a4508c5cd21206fc1381d593297b4e21509e9b1ee050a731a9cf8615485b65cdbc10a662a49e7015792aacad8e15c4c626a54dd248866925bc201a0ae0993c657bc2144f4529510bd748d8e295de0d05214e6184baa4ddf707642fcaac58312f9780bfc71a93a1d0c273c7d047ca7b4723a06bd0f1780302eb90cc577ee8212a85b6598973c8dbc75d6ee455576af3ebe30d7a29bd2b8ca07b22bd51f177294f1fdd758c777f86963b1fd0abf86186fc0109796e769038fc8a28b2a8fe4270df12abd3af68004023954022b6b9fe2b6b3a5980a8cc1c2272fa94e69813af33d549bdc19069008fa395c715aff18946a153a49ae7749419bb8e54974c7ec185f1dcc1b6d5b9ef32252ca44483690a261c77b5815623b2692dc5e8a0ba589d26bfe0b5ee074a45f61043c1a0ccbade59e26a2efcc10fda290b22c873a3de90b1601f5b08354437857a960a02e4e9301384af82388fee954cf6b5a7d9907abac15c20f7d22904e454f3e119b0c5e93b9f95bb97125cca633b76093ee5cdb1eddd52cc71923e22fa1de4a4f0da0cb1affdad34a42409e70d776bf4ca6aaabd8cc4182561c4c878e8c9ed00fde9bfd14247bdaa1f10d82f87888970e7764e3e2537d8b6d0564e8c91a11244962ac866744b9140afc4b515296fbc9ff531ab90868efbdefc6e4d6410aec00f83357723f4ac749bb38bf0f08cc16d26bc5ff4759839eef81a0290ab76183c4aafc4c1528567b379eb50a926fa75ff5ee573a197199fe881173fdf7abc2ac6dc73045f14487d18474497e60aab9d6273800b56f2e3774913e672ac949ecc4305a03decd687189183f088ae2fb97a8b1ab233245c5efabf030499e51b0a8b746aa7b6b11a15bc1898da957496561ebe8a27e8c8255832e2ebf56d242aec1453851b8fa60df4c8c1c67038caaac8ab064bddf2793fe97b6bf497cd47dc9b512a09f82648a568a928a750689ef654e816a8260a0bf876f962e738ff111d6e0402928f9139c13df9e5533d352e90901676caacb8941cf0a1eba924de70dfa793f74c5e10f49c52dbe605cbfbb11cc6a9b57226b96a3972a49ca8586a668054a36c67b4b8ad273c6460b0e3e0dbcd850a7d5e0a47f60f34185df967f1d1655d6d7339f4e5c1fefeffc932d76a7bdbb3bf5f600212eb46c7dcea370914f150e8fdba0fc9e5656ab84826fe76969010ce252c187dc9aead8371550cb9f5ae7e3629fc8ff56c820c885710474a70113b46051551418a4d079c14ffd9cc37323cc61adaf392a565f624ce99eac4de61c6d1f4a4fd4c0e794e683827b1dd4e778a7cc0ff6f183b4fe1b848168510ced6af69d878a93a220ac2ec7c5cc22e08524eb3184edb6a1d4bcf9fac7389a1acb4df0e786d49c57c28f1263a48b49386d76dbd12d413ad1251ae8c97a3a159847aeb07020056acbc61699755675905325ed99698a1a9173832b138e91d0c30722c3c78a9f3d7163cb4bc6b07a6b34447b6776816060b4e3ad5a1fdedfe9ebc1426872580ee47a955a7bf45a6a07dd333b42e3b2b5be5b52a62da75d3fb7c0f7095e3e360315f5ff3e6555b0c37cf8181171821b2d94e3229c77d5dc3915d4c1f87be9b52f82bf4ec36653d23f834172a89035887af3160200dca303a4d45ab0a701a7fdc1b0741185023bba6f243b63add03294783da45fce36077276bb0a1e44d5bd97b28343ef04ed05214c89a35fdae33f6158aa806623a785639c3eaecafade840b25f11a0b3d68fd0b6a83d1c83ad640aa6a657f157b1aeb0e2c727145832a13eb3e97ad58c352f664977fcd92be9e2effe3709beb17124aab8f6131257d26a09a55d5ccb12737eb19ce5c8dfb79edfdfdb40d7663d81d2b17cea7c97d5348ac326002836312ed48914c6ea546fa316b7c6bea248bcc20be07432f07f5c542df09fb866fa94a57f3ac7b682225e5c670b71a34fee10b0006d6d576895b6433d24ceac3a4f13a4a0bfc4f342f731bc929e799d9d49e36bc06f19cc27f024bae73e6ef221afd15440a2b5c639827024087e8b510ba5f11acf16ed763c41df28cfef5bfeb3cea17942c8cb67ff500111b663e0d5767ce248e6ed3b9d5b5786427c84ae56dc0d653eb19118311c97fbcb333bb868218862c51867c118c03ecda0540da34b66c83b847ba6a4e9dca7a55d8055131bb116338d3459d2c9d841f0deaabf31b917f8db6b36b2ad10598517fdc17ffa0a29c7865b246983ca77316ff6e8738e1d1fcebd3151af2068cbc0c6a7563258af29492b0b46acd6c2671ef68e99ee10363a2b52a6dda26886a2c56a8499c2f63b0bc102f509ac685ed25997b57c6f68bd9053add18b4b63ed61ff20987569569b7344f65dbb91abbda08c0a5f349f82beb140c89f603bf56f448e7212333758e1d42d6da56313d3da94ac94c042585f499cdc381368ae41ac3643e178a91993b3e74e913516a6e5e66f27b993eed175ec4e26cbda14a82084a38db90cb73a9d3aa2ccecde46d84daa815d5122405ffc041cee2724c7cc5bb0e29c9deccaa45fa9e9e49ab29e8dc2b6b5c671f4888122978a0eda52ef51570b36600a8640a8c74739fabd010ce1cbdeb3bc6ed4f978f4e4f3a9735226a52d5ccc15cc99134b3baad711d6146f9f03bb950515efb8ff1a952a2ea94e39c152347cd3e0e79ef78a074c8607154cdd1acd024be53ff7bd61b8e336d6f4d2c48c8f0ab6006ff23eac4bda8535cc525d3f23f4484421b43a268275bc6708a174b1ccdc52ee3279692be01a01ca96a011315a8f6ffceb129bc6430a3d06bd664557c37ec218dc0d1aa808cc612789c5a892aca1602f8d0e9eb6f623fdaaf8dbe4ebad97755d7142eaf0ea1a7900e0071910407c154d243c770fbfe8b505d9153cf6bf61fe2b893ed99a3daa00da1ac1e36d11854057bf9b11ed479f48ff157cc7fa15ef13aa1875f62b89c20836e1d6c3d0fca1834e04c4fc23c32ec7d554ac2ee1da277aa73ec9ec0f75625a0431a55d6605daf32d52d9e295f506cbed286dcfb10fd9fed0f656e126eaaa2bd76b67da959ac5ca98217df0da00e907f69a8413f937c6c3e2096140142ad90f906b221a2d648905e5ab6d2c219c8d9a361d30af8ad855fcaac608372e94d479b421f82fa24532dba8ab9364e47407f72eaad99a213a47bb39f51f464a729f9c4c39ce175ee2eb9d21cb3ba403764e81f9728a79aecd0c94227f57ff7a0a521d36bb8c1f73cc6f3abdc9244dd71abafe41e09849e53f9434de6074aeb7fc3538ab63f68864c539ed599cacbe04a4b195ac7c17990e5e9e1beb5150648664dc29ae6bfb177e116399bb4933d9664096c173344ba080aa0cf9bdd2a776259643da70fea12b4846229fb33efb4232113a8d1823fdae286cda923152a64282046cfb41439b06340be3e6996856cb6e4f381532983737027cd1c95449576c8528cac1839ecd88e00004c6356487a8b1b037cbb92c854465a36b9d271197eba40e707e26aa8cd7ce16975a3cb9fea714147aa81eb3284c5a0156158d816b50ee0ccfec1a1f4f4c0204492f5d6244cab2ba8b658aba02110a1385a675d18e24b2ffc59e49948d5373aa230ef486e942ae552ecb96e95d23fe38d0e6205f68e186fcbf0d0cb482206fa2a04766d79fb7333f041bbea352867c3362cbf41956ca91fcd04fb162a5e4324da144c8e3a77b6c1625f54428e5362fd8aceeebd75e113930a2ca1e450398cba3763682540827935468bd27c4360f095fddb1fc2ed4dbad1e185e26d68d60d8e0e8a9b2a0ce9ccdedb68496483c437cd6059d04448bc5e1625212c745eff46e71dbda53c6173ab1c83b553a4ec77acb0581901edbb43939dfbdf8761248468d23bcbeb670ee99386e3d18b1893857fca227fa6d6c525d787e7428ae29c95c38fb4f97641d4947fdbe3b7796af300ee42c4eabb1c0159b94d071bfa3852d5afa4b6964339c94a5500f9c440f76c51ecf01b3e62efe1382c7174053be5333edf7509f7665fe4f0405fc11cabad691eaded1ac9b07c81ed4a9282324a1688e9bf55e5b10387efa92f0e5e0f991f50601d15240860fd8004c367533c2097787ad396b641007496e76edeb086fbdb2ea28fb7c4dfb6a72b4229bcc74260c525635fdf6c07fe33b4cde23cfae812af6970e09a90157b34116a92007d9226e11b95655ee94f3a083874c24545f25c4a900353e025383dee8dfccde8893ac8f597ef66ee17627e557a887c2acf1336a40e6cdd81d4db4861a7c13e712a89333190548f57fee9d56ca2838a288dc6b5690c44c25fa2899b4feea4374bd947cad8494eeb44c52c280619fa6108459d981e5dec7c23ae6155f7cf83ffe2c996bb251d011c86c0b9eccfe8fb20c9f2320edfc60c41d309d782bf0d41115cac6742a82793ff3ff58ce4e0a70066301b101db6c627483ee885274a6fdbe05891d27ac4f17f372d57cf570cc9737e67e5112b804977b4a9ac3d664d0bf1fc2729eafd419f51fee460f11a7e66f1968041684d7c174da5ff7b7d8912836079874a82c7c7176923235f4db3fb3a8c382aa455c29a49f3369b3e643443c884731f20157d05a6c79cedc86dbf2d4e674044ab93c2f3c89fd5c292b43f889c1a413eef3f22832e1d2964d2d58c74561477e0950594b6c4ced31532e0df070a1f356c894a861ddd7283cd99c27c9fe8c1d362dcb27127b166b1abc4154cbe5e3b5f872981e5092e74590113424beef931191825b55195e250c6643752eeb3654740c85fadad57b04ed41902bf516934103f2f2ada5bce5d8b25bef53bff2049ee9e0d86bca5608cd8e38e7ce2f273c632cd5a245f6691c9fd18f42ce3ed16badeb720cf93b4378d4dfc3100cd0834d29974cfefea1b80099c1f3a8b20be07d8cb1eb0d81ddef2f9545a7c39f805d9d94ea303d8e0a56d1a797e09e54533b2091bcfc3803b8c50fb295717c973321c563bcb5394c176c394ab6736e65ffad78dffc2f5836aba46e50dbbd5cddf82fcb39884d24d790e6c0014eb6c2b8b8081255b9abcb9d36eb3b21dd63c1d2f17c04001b6f875e88eaaa6ceb264df95fcbb86127c862f978f3f5f275084adda5213ca841866aff380e1691c91404884e1793b287f3b383660dc1b7e20985b9c83e0b7c2c73cfa848736ecfb3d3cadca10cf342e13847aec8224b24ced100a664ca80fbb4712d1b6021d055bc2825f361e1202c7c3b6f125cbf087866e916093a08cad499165ef65619c168bb93022fbb8f33b78730a5e46f417a6ba3f4067eb43271a2859479203aed4d629fd831c6f9272115995dc465d90a0df8d1e22a3e4aaa5a84f8676c2d58dd20c2cb21cb541b200ac304b9d7f7f0700250b98c0a0118359d2462fa350e5b952eff86bbc8e12a9b5f1819fad688d6e500e2e08d18dc7f207919b7fd391b44e62bfdc97c13403bba76fa19ee6e6b96a28790d43e087f48885b47d7e45450b19d1fdaadf020bdc26a9d3e24636cfa3f1f1156ebcf21fcaa0dc0e5a23a5eb70e6c8af8cc406fd52fadb41cada1a3610f94c0ca6c9fc3015b3c66d775aedd375898f791fa0530da60fc66cd4a73fbb90e143e1f4ae8032239519c84a5c6c6cd78e98ee6590990c0cfb98cf9f2ca68402473add05c0fbdd6b37b3a1df4e7b1a03cf3106007c6a151eb3a7c6ccc74f00a9fd272466e6fdebdbff3f117b35dda001cd7b60838f671adaa0cbef5fb7de2c8d3d070269835258282041519cbf6fc1ba7a8c75c62532800d08832dc89524e40d23bb3800d9c6062cc03ee1ed31b20f781e988b4e2ce707ab382c1d5705dd0955acbea1ecce289d9faf522bef66d2617c0d56f250b31a8f0e6f3621fb3ab46ab7131d6ae7fc6e340ddc860d84e3989888922eec944e9650b0b9fb729255558f899a05d2fd5caaa2192e069de0966d0e25e6e46488fb0d975b6c9d5760b51326a8b8d79af5e642823bbe08959959a803ded1a206b2f206c0cc2368f06fd9425e12826403d88a5718204603a28cf4e13c6a1707d780a8b681ad450c289d22b15ab547f2677958a46f898b0cafa55aa2427131b2bd52dc7232b97a05726d90cfd0fc73da4cba2189e53041130171849b4ac36e2a14c22590875a9d3d03e4f86a0b7947fff0c0f89f211f2ba132920d76db90c977daf1d03f5c2b3cc5a172b3d09faac5c1554d5129c7b50659cf7f26018602f337198db2d5a473bbd71515959d89c5b3042b6834c46a0907ec72b343a97817ed451b4c61db276422fe7313eb9527defe4e0e6c9c2f5f31d8972c01146d3c6fd69ee09bd95c28c77500479ceadcfdae55c084e75c96df31a71fd2177af608eccc4a50f493d5c9f5d84a8abf3cdba659fad9b72bcc4c204d10a4f2516ae460ed3e0d4998e64688c08c6151e55856f671126097ded8b0bffd4fbe3f7bf9cd750fde9e90f37e46aaf7fcdd26dd9c4439ee75f6630f36492135eeb875d8f936888a5cd3022166bc29426df8fff98b0c4433b1e2db42d30575fc242905297529b70173b1cff7083e4e8c44f29e365f7d2cdb4ecb158aec219d1833113b88c5d5bcde4cfcb45270a4121be25249e3eafaacde98a7f9313e6a80b381189412bc5ed248a9be04805fb5a36fa492ce0ca4142c47acc133c4732c908de187f68e62b2a6d6059dc454d8f48d2916b016b37b5fb68b4c23dbd698753044176818559d4b5cde80ac991c577b1e84893a8a9c98f6992cc79247638ee8dbd6103ac9c0f694be3a0a9956821dfe2e4894c261978bf66f3b44056069da526c7560adacbb7fde8929abce48c10e32b35275ebe421cf110bfa4d34e63fbf69f6b9a7f460351efd6f1dbbb8e9a4ac5c533d62f1056dc4421dd790c1e800823a6c1f1829fffe61ba4b316c8a42a4e28eaaaed3cdc5e12de37112095f3e2a2c7eb956c076abc30f802e085d7fd86905f7381b40839ca055cfca22a474f8999f219dd085ad54aa27d6cf2c4f0cb7ca3b794d744f4fe2932aeed59afc328d8bd70323baa5b988ea2ae1bd8f5cc8cf4cf005a43636b29b552ab7daeb08c8abe47a3170886672406a8dfcd36da3ae2dccf7e4652aec12659060e01da4313487cd29f39bd772d1e02f87baf00857e2d8d7d918e542399db7447e6528313f5f25783a8fe8c1353417c99a26e25d91d9cd72f079908574240b868ae57cd729768feabd97bec26308f00ad1c2d8497a29eed64bf7e1944bc8e5145a26b17c6b4bb00f68f63182740ce29eabb99252294a845dedeada83d6e28ee25606ed7d6297660c6452de314ae23a26296f916f2f6ee0331859f00440b10cf3e2d19d570aab3245aa2f0d65f7326d6a20c8cb563371cd87dd5dfddc3e7ce93690728d243c20f851d6bcecc4c902b6e26a12a143fe9f2a8a7acc915ded346f6a11d0fbed245f4c61b07b0115193981b2a5cc0d6b533b656dce964d24a091e29f9bad866ff01a4ccf4f109ad554181b8d2c99103e526501d7b1c79db5ce0781a52472efd492ee1fa109ef27e39c4d3c959bca5bf12f6b991e190b61fd6a530153f48cde7df263f90fc4a9518b0095dedbb12b0456340cfeec87c2ca9f920016449f8329e4f7ff56b9d7894b341e7094d67eeb33ed1d21755434216f17245aae46921d51429eef94dc8b4ff11d544fbc2a1e12aa3f7ac9ae08ce04305edb86542f7fa83b597f4bb09ecfd20bb151ec8aa02ea4e662c4e0a246c96ea2566dcabafee239c0f9067f6f36dee8f51ec0b5552ef7023775ecea618b381e56bbb215fcab84e5d66306e73ef6d3bba3f17ab2e1c1c22ec096a40e1f1376aa5cc8e0e98eb22ff03bdd2b45d23414c5c8a6bdb2574f44b16d9ebf31e57e8459c1a826ee8d514574e71837d5767747974f01173b05dfb26e42a53c716e16b87596bfc4ad827413f973c76906ab96fff36275ff9334efab3d20cf12ddded357d3fb7b63ca36dfd44a82af04b30c24168bb48efcc90eab477f861910a3e20e8b0cf29a9b45f3190cf0897f450df98311f17856af11d5b2654d43473ff7558dd83aab05fcb19b177991d0530efdd3017b7ed1517e1d60388e66bb2e4997a9335e0827d271cecb380fa2203aef1e9d528d5a4a72155aaa28f2ad4f504a58bea0fb25c60cfb74be9aac76c991e598c2fed1adc2665e9f8f0fbbe1634158da82eafe7ec98878c9f1f796fada6683d1f8301e302175d0411671adec69657f93b81a1b2a2cfe09aad58f43264bec5f5fc70575a934573813adb24a9cdbccada74ef126827cd88ee69b3f6b0ea9e0f0be51d76ff01c4177fdf0d5d1ed608e690f209c1dca13b361e642a11f9f6dfe4ab35b389c3ce434fe8df3c8b52cdb57977fd30baa1a941e5e2bc1053570f80d559b584fc8d57c1cf9b0a0a9817f8d0aba830b2bde130ee04f648ad3fc82574400d2823db035e8b30202df69a4adae9df8f176bdc8f13c2b3773267520b2d3ed6458b7425a78f8328c9ba96d0012d8026f5b9eaf27e4573576af37b7f1134698bfdefda3ae136cd060940a8b1e5b069492acebbd7a487c4614e17ab9e0ec2663175e985b156d6dd9095d89c01a8ef114a6cbd5e7d526880b8dea89389ae9113fa0c45ea0f6d59b55532306d850e8bab46d438dcd103e66bcd0047cd3ef3b0c45cb31462e87034ca2ff6ebfee99213ad56da0f8df22ef960553021664fbec9443109a3622d45897db6bca0a7dbc769315f2d91cf0e8b2b6eb86b57d3a20c069bbe8081457b116711fb88c82b5e5c3eeb94a654eedd654af0009f55089e1c13757a71b7127ee599ed1efb88e8e41614cc0955ec012699c51362c8d44af4ba416da351413cee14d5e52d132f4175033c87bfd22c827c8731dad9548b71922d3b5bd4321d48fcb38900129c0500c3616a8260a5c5e451f891cc8e828ad7f5271bfb0adacecd49463a3829d13233c07fcfbdb218300ae3328287cd6f41a65a7ccd111c43100c8d86e5cfe83317c1ec8a4dcb4b6c7209ca8e18626425ff6fff8c7ba7b1e067cc6446afd68bceeab02758ff23049520ff44577f20bf82ba19e071afb3a4314103528c52af24da293f464a80c975c76b1263db14b3ec06cd4fc4bc75ea0d369bd943466f3d49eaea3adb1ff6f47072e940ac556459bf9f8fabad4471e4c9c5df6618c5bd0c3d94f72b1df15dd06b06e89bf9f1b11277518315a2e7ad8447d02c1e84764fd7dfa98b2bf14b6fc50fabaa54c2dcaab3cdb6929d662de95cd8066080e25053e882d1eb5c9375c54cea563788aa5c1d4a7a15227f400546b7bfb993aff0fe79df9a6a15be03ca10983e6fb9c20e775b4b19ee929c04427ba639ecd8bdc6173e314b0c9fafe51fd00901dbd3c4633318b6dd656827bcda6d012facd558948419bea0b874d54298c69e3b742bafab5011a3ca03ed3045b8dab64cc04d85f2c1144281963ac642cf71c34635b168dff94f4606363a2715f7f64a2f380ffe9c3266f841492199a5b9a2332ea0f69416c435b174e7091d9647e08dbdeee5868d660de01d60b1e78549502b0c0256a6d20f16b937b789487ca2409a8afc4bb5ddb191f94106d8e375e627bcb3d861f98829de61b74692543b15b66c75e49a9c9906f056ce9ac6bc368b6ea16f9fd9990de332723af423a3886ba6c0e013f3c6b26279ae9edd713517f8c121d271a9cbe88870a9566596fb860d657c5ea48060d7f117d731c91ae07047a3054076fe0d6885e2676eba314be472bdcb70eef9c263542835531646d662449b32a984817deb9c6387ce1c6239265ed73812aa0c3dde5ef5df39840a0f301f3b6b33b4455294e1b9cc6ddb0418bb9a8620b28c0e11aad42415cca14bbcd13dea86c4692f81b211a5f33508815236d63ab529b385d6d2a30bff777c753bf9bea6c8ae43175e71f0bc36967b2b0bf6b77fe2bda025ef5c3738571441929e41a70407ae7f0cda8156bb8ed3efac5171c3d26eabd2f767905bf34b0068c5e3844218fc299849e93d53ee00d34e2bf7114ecb0dbd5e27451fa2aad1a263bab92bfe26c89f2699434a3bcae16ce492211b11aab295212ff288e057671d1a71eb43e92c05bd12872100ee652b2756e563d45de03daa8771bad2ab60a1ac909b404d268765674c669d21a1070dcd11960e2fdd54e92fc03818e1fc28b9184b2dfca0effe81f873bd2fae83626412b5baca23119bfa42646e577b14e6f27d877f7ea0867420ed3d38fd05499d2dcc1eddf72aff5534f0ed05b68f10d2d749bcd8b72b0cf26118b7e8dda081e601d0fee14b7c0110f29e160bd34eef7abb0e873fd45589c6e5e64d1f63e9efea46ff68f0f70b5ef295845daa5f5cb2e26a4c37795142f933088abd27414833b22743a1e9bd40d3bfaf9de8bc7c3fb9f4118c38ce6b82e203407d802a2eb8a9680194797abc9ed30279e7f2623ad0d0ab4fa8e38d3b0328a43174c2f9bdb1ffa515e58aec95ecf3dda94e84c9ad3897d51196d76965319635e2ef0305fe2d3facec6ad3908d71b67cca3d0660db92c3a823b904acb4acc033c1064c28e9568008fe18afd941ba73a79a3f661e2bc2fd6316b7c8f6df470b267b139fb5cb1198aa468233f5962b157c06e8a7509446052fb8e50942ef49488d4784cc339affc89fa8dbfbcbb4698ee9dca75dfd9ab1daea2d6fee984ab4639a566777282096164c514556aa9d0753222238d07f7e90b9c06e43692e2f0bcb938e352beb708304a9565f74b16d0744ebb9d09cb753d1510ecc835b75026f39d9324a6c729d0794ee9e4738b2dba74d58abafc209112d500b48eb6897178a807f3faf9f0274894dc3f1b8de0c0e5fb00f4a827455f3a5a09f42a514639aac5df90b63d86b09ebb385e0ce8e86aa83c902e2dbce9cea82013fc87ab2e59ea34e247d789166cb825cf93cd4b13cba4dbeeafba470cbcd999758eff4deedcbb6bfceb735fa94d1e7ccde19dce4454a985c028d9b26a9ad24d6e1205fd6088a3f740bd9505ed71d2c44ca30c793a4f05cf44c1fca6d4a2fb7dedacb26e018f57f14cb0b192c4e6cfa1204478cbe0088a0e13af38085b30089c8589d4485f733b6c8fe1e4bdce36f00965dc93d23c0ed41d198dbd72232f7432b3c1aabe4676420116fe711dd30a482e48146ec76dc091435da02c7170413fbabbef41709ce4d6d3ae568e771075295fc752078c3b2cc28a68ec1a0ef5b5f158328027431de27f0897e323b32c5553d37fb806f178a98f331f25c36882bb96ecd9781cc2e36588f0c0d2d1219f27b4d1b98a1183764191bbc37a03356e946e1fb935244bcd13739ab758fe7eb8a75524aaf0977c234f338d03c6a023182fd261dd7e34d26f92dfa8e4a225f08058675e68d343d7cacb5d16806361bf0f6cfed303d054eb874cb0e5a1b573103dc794683746093d5b69d8d418fd22471da1d3e28d2f08ea487bae6908e7ddf9f1f42a0b1e43f8b7fd72d7e33bfe4ab36a3b592d1ed5c7506c95618a1933fa03647f36125e3aa991d38887d331743e1cfae934106d6cbbd2bca9cdc327b1f54ea4e2c04f00166388dfb5c9bb13934598898e63a1d20f33856035b4d65c8d72174fce21c8c552e8843a57ee47db18787d1129ce2583341e618f5c9be339f172f9a10e3aaf29e865cdf0eea4473551d51a139d59b087f6393a4e004ff53d82e5070da11d2ab86ab191ef8e819122d50161e26dc08177010fe2b73bb94065b499b5e10cbbc3faff21aa5eb1bbc963f7e8fc28423f2f97599730bba5238a5d96c0cf304d6d979f00e80f9f2b52f38356e23f4e8fc7e853812f9ecf20579b26b776277e9d3d0ed1f74022d5b691790a1a5d7fab10c532f82cfbe2a793d4c7e7ed969eb2b6c5e8c9ac362088fa8c7f01b9833259f4025a0047eb7293e8aab68fec0eb2ff84344ab5b444a9459b340a22750e18f505995a940b12c494164e18fa6b804c78836e1e175d7e91948c8d639dfa897bf2fc1f79e67b1e686805c244bd5b990e4f70638e64efa8a070f697d7fa27fd5ca7b515c7f1aea790e481a6ae0ba4bfebddd02167f2b8f82dc2a8ad1c0924d8c06ac00bddba6286b77516d07145adffd871310b7df6f340e30b266fd96ec0d52102ac1a6b0d105d70ad388a9fcc11131deed6734a6c093a9c49757bc143774d541f6defc77ed05cebddd1e4bdbf39c21f012c3a40b64200ce1d07106a00b3c5cef9d4915861cf054fe4b62ce5ab9eef719d060c27f23f1a0d0572210f4e4630e75c39c4725a7aba5773529e970cca757e7fa93ba7777a5bba71732a8684f1e672acf607b77568135159690c843c61d66615c76ddbdffaf58dd3f2eaf009e377753b0149147e99c3b00fef7b60d05c7e298f5ad8d8de35e71c9af9df2ddb872d35bd12e2f86682f2f8675e8f68a6df954ac0c1b5078f9e6fefe34de09ceee62cc31c9e0524ac94293d57e0c9cfdf754beea40421bdcbb65227fa7fda0443b7ab48e7ca57bf1cca2cbbf3a88960949359d6f192ccb09850244866d19a50cb933ac5af52c3db47ae2bc6d6fe52593503efa760ee94681734f2bf3e98a882aa5e25af2a291058155811c83e4309bab110fddda3af1379382c20dd755870f651115cc40b1f5b8482289942e0d5600df208d29d859c6d8715288f358c7c499104314c73b5904826b4e2c4b4e386b1381c7625819b4e354b08a6717a8054e9a045a95b89c8c8d979fb8e319ad69afadbd0fbd27fc19adbecb2613eb3f315219c3182aff3924140322fbaa6b778a953d59e44e1ffe2f928a2f2f6ee00ff70f1b8c2c213d73bdf041a4efb4b95bb8d67e1c28231db3ecde0868e27b87cf2d9539c10d8b03db6b2b9674503fec7d940dfb610ac609272c201f2909aecf9b8612f00522ad4c03c720654535dd535aaad384d6c79d86138e1909d9c513a2f2c4698a74c06581bc687bc3293150d2329951a1ce223b7bbe32d751fd02ea7aa190bfbdc16568c1aba10fcf5d4dcee981e3daf84a79f0c0b6bd4ae152a69c63cdf93fb9e14b6dae55be287b4632c97d3fe27d656a2b3b8e68b3b5279f4da226c93fb6f607eeb8cd8e1839580ed67928699d7f15e13fa8c35e145eea5aad79d56cc95634cd73f268418aa83e4abc8adfbabfcdf534e5b8526fe772cf3d59a363dc7aa1ade640da29eb903530c961c2f3f7dce18ab0eaa79f2f9fe9fb6e73c49949d924fc8db42fae3a9e96a42cdfd31f69a57e0683b8d9d73968c6972673b3a1150b6518328cef0873c7aba180aa4208afe5b81dbade846cdbd7298d7a3c5d88726a7e22ef82acdd9dbf1f66f7dbf36483a1e5e7b200b6216c73666fa317eb90c66913ee1ba2b612fed8b6819c8ae89a2150efe88240414a7f18abc3261f1b5cf8217e8617ddd1adb4c8c7fcb09bcc85820903f470ffa4ffd7e29911b429c593c80b88b355d4cf2583055b8d4f1a069c9e26346bf90f049baa81411a590c7556949e546f851178c0402f3a653e4a3a77f0c499c98fd22d5d8bc45fb93afe06e5e583e2ca643ab63aa5747996efc89cf0933f0ced7bfa7a0b496cbdba89a95bc6810d85f6f1e604295c55119e19d994189c66f3712b3597d16596675f4f0a8ea97c9a50df3e596eb4eb4bfa540c0056b31a2e4a2abb6f48e4771027d4f5a92f3f9a2772ca0a1915602c1ececb5b064bb686ec50f53bd9f1a9c2ad0ad8de17dd452727efd61408a5f22be61ffdf06c35036dc0f7e0e1c2d6201b31cd688359426c0565dbe52599ca3cceea1d3f9767ee83c7d3d7166d11b3583396027ca087f587d0d8360e9b2cc8d76b87f74668ab33350b9d885bd2dfc592d8569fe4c23e3cc2eef4b53056729421e88d950966820e6c49cf021659f373c5569df034fb65e6d196317d03fcacb3d73d4b95e666180bd0bf93edb4b9c253cb4af1a1a8527c17981a42013e6e133a524054dc36e3c7e24131ca78bf453a04a48603bc76539d700eb69c38a5440addc235edb96d43c4e8b28fd886ccb5485a4934383d9d6201aa38d1b9177a93e1f674fd8615b1281182a42818541277d1183eb2d51599b9ff11877a6e17fc8aa3ef3255bfb7060a83163e4320799c14fad597ab3f1b404e674a388c15ac3a97174847d6e1e614be7732bc2e59054b55ee5b4bcebb446940f24f92cdecd5c9c1371bd25763da8c4039c5d7f5814fae0a253a634d12c7b85a8be3a9dceed586a763c286deb81fa2f70d3fd5cfb4b87706df3968040b6866b32577da70454f5966410ed883bf1b1b06983c3e6f08dea694c67ddd1f858b06bd5380f8b955e400a2a0d14f8059ae97188e1fc68c0a57c95a4ecf3ed2f04db51e7239d0488e1ef6a2e9cdd6132199428ab9f04b895209b5c51156682821d604cf861874b5f1a5ff244ce67b6d3112722e0c88fc181549d0503adcd6e120d6daf8cfacc74728bf04a7e4f29bc64605b95d7c68574e94f2fe36735780c4dda78120d3f48e261ec1beb98f10de5ac440ae513e09f495bcff266a9933fcb774e23cd69cda68def44292014594acd937e067d60bd69bd794e544639a35515ef73129d14a19c5a56dad7e347f59a49e5f4bde659b154e67fc878faf00dea6457e74071aa3b2a2f61a4408938dad37caee4ed2eaac24510fa0612d0a8a39538b596ed0dec6688645e33d6d81e3fff0d4b67777a8f37aa8cad81744d465207479501418b6d4943225e148c265080dfeb7ea0317cbeaaf89efb0c6d50780165fb0a8cf5df40bad25f4c0db1a1a35ecbaff785048213349485a52fb2c2584e4deff6902707679419da84b623ad83914cb10cbc46bb1f5d967991c5c35897775039acf85599ecf4af6161782ce9b846c7afdcd6f809bec3c99a7de9f67c0cbd3983616c8fc1eae81aebc545134ccc6caa8c314db9c818ac3d7ae108fdfd1fd45de4a2591cf5fba3e1480ce3be2f5f5a9d1dcff3f813303648cb00d27b0acc1e12da4273589d6df416e9a2c711659c8ab5b9b8ef6f5aeccabad4cc99dd35ceba326bf6bea1075141c5bf069a25f9c02913c58aaff0875c99e977368ace874a842ab4dc952fa50991eab092b4657729b9e51b50b38f685a93ad59d8264a0f3819568a336f6ad7c2e84ba997451971739e583f8e13ec04ab16644010ce2a2223bf01e424b9799ff2bd3cf6688f466a3d2bbc09d4fdb77f4944fe635720f5dd7cb0ba1597498366f94b302dd4274aaa2fc560fff4a2cd6b02bcc18932b51656da3666496ed7c591a85ae91ad9a03c48022122ae1b5992d9f78381545b2b5d092d112f5b49717d1f5b5ed2b47e90c8fc91cbb24599bcc6eca44e1443aa716b7ed47599d7a73cc3a1a8947f45d025889a157a5de9fba60870f9ebe077d41762e71afcf7a7a844a843132435b0979c0cf54b4789fad05d65d3ab8aec7684e41feebd885fe046b6c2fd85accbe0b471b1625c9e9b5173c3f50c9313081714f0fa3656be12911f50696cc0a8f90d081da391f510da4acb090a835e2ec728279b424f3a39b557164d09c8a3cc8bdcaa440f3609db16acbae60ca33ba3dd7b52e92214b6d6d4709954ee30746b4468061375e27d045f1f251ba06031f57075b78ffe315b671edfe814f7948431cc114779e74f0f0142f79737a532a6fa126e9554bf17074cfb5691e6e2d59b91735e797056aca5c3c4405c5b331e1c70dbb5abe054e03d01cbfa0b176c8ac60f028f523cd991b18031fcea407d21cf9d5998c569ae91561422010c9f775521717b851d827604ffff2c7f28d6b09f9edf8575704b34a8972f87b63b8fbbf1afc92ebd0c73d2d3d222d8ce95edd89193309d00a1ad8254f0d34713294d3d3b98f96ef597b91687975776648106a41a680a15af067492ba3278f8ce9555c93c3fc8519adbedd0fa3bcca20fe4f3db94a8dfa96bea321e55491eda29d1ff8686e1cea03d489eae39fbc82856e99bc35315e39c03af76635b515bb46fc0996579bd6c658fdff773b23f93fcaa42245fbc852e19c4ff254e54f1a5872fef37507fefc037506978bfba68137636c387ed86d0277a7ae0828150c69e601ed967f75c459641dd70af59bfe4f3b94029ed035b0bd32a583c5370b4fa29af51d7e8adfef44c8d8c3846256ea8c135a5f4850066462c9bad44c898ff1c56f6c8083301cf9c13ab538f09f4f39164c92d908b99df3c9e66fe1892df6ae04efe3a40b734aa8ba0325c81cd8e68be8de57028e495b2b055fc48477969ac443587c1f591a993b2701a0536ef7485f67f50b731b903a91af018633af742c5227bdeebd66db7fce9de6b0307ebfc81bc0e5d198552ded11fcdb217387fc63dbf6afe085208e6257ac53aef0c29e7ac5b12d5418d235fb4894aeebc1880f48f67cc2a549c0a2ef83ebedecebdd6a9d15aab33ecbbacbb1f8b19dfda421a0b11120fe37c6f95b9f5d395f4bcbc925ede86a483247b76931b78f2b276988d21d4950a457fed70f7b81519be9a584","isRememberEnabled":true,"rememberDurationInDays":1,"staticryptSaltUniqueVariableName":"ab7e469948e4989d322e29867cb59cf1"};

            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                if (!isSuccessful) {
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
